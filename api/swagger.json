{
    "swagger": "2.0",
    "info": {
        "description": "Mirador Core is a comprehensive observability and analytics platform that provides KPI definitions and unified queries for monitoring and analyzing system metrics.",
        "title": "Mirador Core API",
        "termsOfService": "http://swagger.io/terms/",
        "contact": {
            "name": "Platform Builds Team",
            "url": "https://github.com/platformbuilds/mirador-core",
            "email": "support@platformbuilds.org"
        },
        "license": {
            "name": "Apache 2.0",
            "url": "http://www.apache.org/licenses/LICENSE-2.0.html"
        },
        "version": "8.0.0"
    },
    "host": "localhost:8010",
    "basePath": "/api/v1",
    "paths": {
        "/api/v1/kpi/defs": {
            "get": {
                "description": "Retrieve a paginated list of KPI definitions with optional filtering by tags",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "kpi-definitions"
                ],
                "summary": "Get KPI definitions",
                "parameters": [
                    {
                        "type": "array",
                        "items": {
                            "type": "string"
                        },
                        "collectionFormat": "csv",
                        "description": "Filter by tags (comma-separated)",
                        "name": "tags",
                        "in": "query"
                    },
                    {
                        "maximum": 100,
                        "minimum": 1,
                        "type": "integer",
                        "description": "Maximum number of results (default: 10)",
                        "name": "limit",
                        "in": "query"
                    },
                    {
                        "minimum": 0,
                        "type": "integer",
                        "description": "Pagination offset (default: 0)",
                        "name": "offset",
                        "in": "query"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/github_com_platformbuilds_mirador-core_internal_models.KPIListResponse"
                        }
                    },
                    "400": {
                        "description": "error: invalid query parameters",
                        "schema": {
                            "type": "object",
                            "additionalProperties": {
                                "type": "string"
                            }
                        }
                    },
                    "500": {
                        "description": "error: failed to list KPIs",
                        "schema": {
                            "type": "object",
                            "additionalProperties": {
                                "type": "string"
                            }
                        }
                    }
                }
            },
            "post": {
                "description": "Create a new KPI definition or update an existing one. If ID is not provided, a new UUID will be generated.",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "kpi-definitions"
                ],
                "summary": "Create or update KPI definition",
                "parameters": [
                    {
                        "description": "KPI definition payload",
                        "name": "kpi",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/github_com_platformbuilds_mirador-core_internal_models.KPIDefinitionRequest"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "status: ok, id: kpi_id",
                        "schema": {
                            "type": "object",
                            "additionalProperties": true
                        }
                    },
                    "400": {
                        "description": "error: invalid payload or validation error",
                        "schema": {
                            "type": "object",
                            "additionalProperties": {
                                "type": "string"
                            }
                        }
                    },
                    "500": {
                        "description": "error: failed to upsert KPI",
                        "schema": {
                            "type": "object",
                            "additionalProperties": {
                                "type": "string"
                            }
                        }
                    }
                }
            }
        },
        "/api/v1/kpi/defs/{id}": {
            "delete": {
                "description": "Delete a KPI definition by its ID. Requires confirmation via query parameter.",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "kpi-definitions"
                ],
                "summary": "Delete KPI definition",
                "parameters": [
                    {
                        "type": "string",
                        "description": "KPI definition ID",
                        "name": "id",
                        "in": "path",
                        "required": true
                    },
                    {
                        "enum": [
                            "1",
                            "true",
                            "yes"
                        ],
                        "type": "string",
                        "description": "Confirmation flag (1, true, or yes)",
                        "name": "confirm",
                        "in": "query",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "status: deleted",
                        "schema": {
                            "type": "object",
                            "additionalProperties": true
                        }
                    },
                    "400": {
                        "description": "error: missing id or confirmation required",
                        "schema": {
                            "type": "object",
                            "additionalProperties": {
                                "type": "string"
                            }
                        }
                    },
                    "500": {
                        "description": "error: failed to delete KPI",
                        "schema": {
                            "type": "object",
                            "additionalProperties": {
                                "type": "string"
                            }
                        }
                    }
                }
            }
        },
        "/api/v1/mira/rca_analyze": {
            "post": {
                "description": "Translates technical RCA output into non-technical narrative using AI (MIRA - Mirador Intelligent Research Assistant). Supports multiple providers: OpenAI, Anthropic, vLLM, Ollama. Responses are cached for cost optimization.",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "mira"
                ],
                "summary": "Generate non-technical RCA explanation",
                "parameters": [
                    {
                        "description": "RCA response payload from /api/v1/unified/rca",
                        "name": "rcaData",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/internal_api_handlers.MIRARCARequest"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "status: success, data: {explanation, tokensUsed, provider, model, generatedAt, cached, generationTimeMs}",
                        "schema": {
                            "type": "object",
                            "additionalProperties": true
                        }
                    },
                    "400": {
                        "description": "status: error, error: invalid_json_payload | invalid_rca_data",
                        "schema": {
                            "type": "object",
                            "additionalProperties": true
                        }
                    },
                    "429": {
                        "description": "status: error, error: rate_limit_exceeded",
                        "schema": {
                            "type": "object",
                            "additionalProperties": true
                        }
                    },
                    "500": {
                        "description": "status: error, error: toon_conversion_failed | prompt_rendering_failed | mira_generation_failed",
                        "schema": {
                            "type": "object",
                            "additionalProperties": true
                        }
                    }
                }
            }
        }
    },
    "definitions": {
        "github_com_platformbuilds_mirador-core_internal_models.EvidenceRefDTO": {
            "type": "object",
            "properties": {
                "details": {
                    "type": "string"
                },
                "id": {
                    "type": "string"
                },
                "type": {
                    "type": "string"
                }
            }
        },
        "github_com_platformbuilds_mirador-core_internal_models.IncidentContextDTO": {
            "type": "object",
            "properties": {
                "id": {
                    "type": "string"
                },
                "impactService": {
                    "type": "string"
                },
                "impactServiceUuid": {
                    "description": "ImpactServiceUUID is the original UUID if ImpactService was resolved from a KPI",
                    "type": "string"
                },
                "impactSummary": {
                    "type": "string"
                },
                "metricName": {
                    "type": "string"
                },
                "metricNameUuid": {
                    "description": "MetricNameUUID is the original UUID if MetricName was resolved from a KPI",
                    "type": "string"
                },
                "severity": {
                    "type": "number"
                },
                "timeEnd": {
                    "type": "string"
                },
                "timeStart": {
                    "type": "string"
                }
            }
        },
        "github_com_platformbuilds_mirador-core_internal_models.KPIDefinition": {
            "type": "object",
            "properties": {
                "aggregationWindowHint": {
                    "description": "AggregationWindowHint suggests a preferred aggregation window (e.g. \"1m\", \"5m\").",
                    "type": "string"
                },
                "businessImpact": {
                    "description": "BusinessImpact explains the user/business consequence when this KPI degrades.",
                    "type": "string"
                },
                "category": {
                    "description": "Category is a free-form category for additional grouping/classification.",
                    "type": "string"
                },
                "classifier": {
                    "description": "Classifier is the measurement category (latency, errors, tps, cpu_utilization, anomaly_score, ...).",
                    "type": "string"
                },
                "componentType": {
                    "description": "ComponentType indicates the type of component this KPI maps to (springboot, kafka-broker, cassandra-node, node, valkey, ...).",
                    "type": "string"
                },
                "createdAt": {
                    "type": "string"
                },
                "datastore": {
                    "description": "Datastore is the telemetry/metrics store where this KPI is sourced from (victoriametrics, clickhouse, ...).",
                    "type": "string"
                },
                "definition": {
                    "description": "Definition of what the signal means",
                    "type": "string"
                },
                "dimensionsHint": {
                    "description": "DimensionsHint lists key dimensions expected on this KPI (e.g. [\"service.name\", \"orgId\"]).",
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "domain": {
                    "description": "Domain indicates the business or technical domain this KPI applies to (payments, kafka, cassandra, infra, ...).",
                    "type": "string"
                },
                "emotionalImpact": {
                    "description": "EmotionalImpact is an optional short severity/emotive hint for narrative generation.",
                    "type": "string"
                },
                "examples": {
                    "description": "Examples contains example values/contexts; stored as arbitrary JSON objects.",
                    "type": "array",
                    "items": {
                        "type": "object",
                        "additionalProperties": true
                    }
                },
                "format": {
                    "type": "string"
                },
                "formula": {
                    "description": "Formula holds the raw query/formula string; treated as opaque by the engines.",
                    "type": "string"
                },
                "id": {
                    "type": "string"
                },
                "kind": {
                    "description": "\"business\" or \"tech\"",
                    "type": "string"
                },
                "layer": {
                    "description": "Layer indicates whether the KPI is an impact or cause signal. Allowed: \"impact\", \"cause\".",
                    "type": "string"
                },
                "name": {
                    "type": "string"
                },
                "namespace": {
                    "description": "Namespace groups related KPIs (e.g. file or collection name).\nExample: \"apigw_springboot_top_10_kpi\".",
                    "type": "string"
                },
                "query": {
                    "description": "JSON query definition",
                    "type": "object",
                    "additionalProperties": true
                },
                "queryType": {
                    "description": "QueryType indicates the query language or type (MetricsQL, SQL, PromQL, etc.).",
                    "type": "string"
                },
                "retryAllowed": {
                    "description": "RetryAllowed indicates whether automated retry logic is permitted for incidents related to this KPI.",
                    "type": "boolean"
                },
                "sentiment": {
                    "description": "\"NEGATIVE\", \"POSITIVE\", or \"NEUTRAL\" - increase sentiment",
                    "type": "string"
                },
                "serviceFamily": {
                    "description": "ServiceFamily groups related services (apigw, oltp, issuer-bank, ...).",
                    "type": "string"
                },
                "signalType": {
                    "description": "SignalType is the high-level signal kind (metrics, traces, logs, business, synthetic, ...).",
                    "type": "string"
                },
                "source": {
                    "description": "Source identifies where this KPI definition originated (seed file, tool, etc.).",
                    "type": "string"
                },
                "sourceId": {
                    "description": "SourceID is a short identifier within the source (e.g. CSV row key).",
                    "type": "string"
                },
                "sparkline": {
                    "description": "JSON sparkline config",
                    "type": "object",
                    "additionalProperties": true
                },
                "tags": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "thresholds": {
                    "description": "JSON thresholds array",
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/github_com_platformbuilds_mirador-core_internal_models.Threshold"
                    }
                },
                "unit": {
                    "type": "string"
                },
                "updatedAt": {
                    "type": "string"
                },
                "visibility": {
                    "description": "\"private\", \"team\", \"org\"",
                    "type": "string"
                }
            }
        },
        "github_com_platformbuilds_mirador-core_internal_models.KPIDefinitionRequest": {
            "type": "object",
            "properties": {
                "kpiDefinition": {
                    "$ref": "#/definitions/github_com_platformbuilds_mirador-core_internal_models.KPIDefinition"
                }
            }
        },
        "github_com_platformbuilds_mirador-core_internal_models.KPIListResponse": {
            "type": "object",
            "properties": {
                "kpiDefinitions": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/github_com_platformbuilds_mirador-core_internal_models.KPIDefinition"
                    }
                },
                "nextOffset": {
                    "type": "integer"
                },
                "total": {
                    "type": "integer"
                }
            }
        },
        "github_com_platformbuilds_mirador-core_internal_models.RCAChainDTO": {
            "type": "object",
            "properties": {
                "durationHops": {
                    "description": "DurationHops number of steps",
                    "type": "integer"
                },
                "impactPath": {
                    "description": "ImpactPath service names",
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "rank": {
                    "description": "Rank (1 = best chain)",
                    "type": "integer"
                },
                "score": {
                    "description": "Score of this chain",
                    "type": "number"
                },
                "steps": {
                    "description": "Steps in the chain from impact to root cause",
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/github_com_platformbuilds_mirador-core_internal_models.RCAStepDTO"
                    }
                }
            }
        },
        "github_com_platformbuilds_mirador-core_internal_models.RCADiagnosticsDTO": {
            "type": "object",
            "properties": {
                "dimensionDetectionStatus": {
                    "description": "DimensionDetectionStatus maps dimension keys to detection status",
                    "type": "object",
                    "additionalProperties": {
                        "type": "boolean"
                    }
                },
                "isolationForestIssues": {
                    "description": "IsolationForestIssues lists any potential IsolationForest tuning issues",
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "metricsQueryErrors": {
                    "description": "MetricsQueryErrors captures any metrics query issues",
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "missingLabels": {
                    "description": "MissingLabels lists standard labels not found in the metrics",
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "reducedAccuracyReasons": {
                    "description": "ReducedAccuracyReasons explains why confidence is lower than optimal",
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                }
            }
        },
        "github_com_platformbuilds_mirador-core_internal_models.RCAIncidentDTO": {
            "type": "object",
            "properties": {
                "chains": {
                    "description": "Chains are all candidate RCA chains",
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/github_com_platformbuilds_mirador-core_internal_models.RCAChainDTO"
                    }
                },
                "diagnostics": {
                    "description": "Diagnostics contains warnings about missing labels, dimension detection, IsolationForest tuning, etc.",
                    "allOf": [
                        {
                            "$ref": "#/definitions/github_com_platformbuilds_mirador-core_internal_models.RCADiagnosticsDTO"
                        }
                    ]
                },
                "generatedAt": {
                    "description": "GeneratedAt is when this RCA was computed",
                    "type": "string"
                },
                "impact": {
                    "description": "Impact is the incident context",
                    "allOf": [
                        {
                            "$ref": "#/definitions/github_com_platformbuilds_mirador-core_internal_models.IncidentContextDTO"
                        }
                    ]
                },
                "notes": {
                    "description": "Notes are optional observations",
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "rootCause": {
                    "description": "RootCause is the selected root cause step",
                    "allOf": [
                        {
                            "$ref": "#/definitions/github_com_platformbuilds_mirador-core_internal_models.RCAStepDTO"
                        }
                    ]
                },
                "score": {
                    "description": "Score is the overall confidence (0..1)",
                    "type": "number"
                },
                "timeRings": {
                    "description": "TimeRings describes the time ring definitions and per-chain computed ranges\nrelative to the incident peak time. This is optional and may be empty.",
                    "allOf": [
                        {
                            "$ref": "#/definitions/github_com_platformbuilds_mirador-core_internal_models.TimeRingsDTO"
                        }
                    ]
                }
            }
        },
        "github_com_platformbuilds_mirador-core_internal_models.RCAResponse": {
            "type": "object",
            "properties": {
                "data": {
                    "description": "Data contains the RCAIncidentDTO if successful",
                    "allOf": [
                        {
                            "$ref": "#/definitions/github_com_platformbuilds_mirador-core_internal_models.RCAIncidentDTO"
                        }
                    ]
                },
                "error": {
                    "description": "Error message if status is \"error\"",
                    "type": "string"
                },
                "status": {
                    "description": "Status is \"success\" or \"error\"",
                    "type": "string"
                },
                "timestamp": {
                    "description": "Timestamp when the response was generated",
                    "type": "string"
                }
            }
        },
        "github_com_platformbuilds_mirador-core_internal_models.RCAStepDTO": {
            "type": "object",
            "properties": {
                "component": {
                    "description": "Component name (resolved from KPI if applicable, otherwise component identifier)",
                    "type": "string"
                },
                "componentUuid": {
                    "description": "ComponentUUID is the original UUID if Component was resolved from a KPI",
                    "type": "string"
                },
                "direction": {
                    "description": "Direction (upstream/downstream/same/unknown)",
                    "type": "string"
                },
                "distance": {
                    "description": "Distance in hops to impact service",
                    "type": "integer"
                },
                "evidence": {
                    "description": "Evidence references",
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/github_com_platformbuilds_mirador-core_internal_models.EvidenceRefDTO"
                    }
                },
                "kpiFormula": {
                    "description": "KPIFormula is the query formula of the KPI if Service/Component is a KPI UUID",
                    "type": "string"
                },
                "kpiName": {
                    "description": "KPIName is the human-readable name of the KPI if Service/Component is a KPI UUID",
                    "type": "string"
                },
                "ring": {
                    "description": "Ring classification",
                    "type": "string"
                },
                "score": {
                    "description": "Score for this step",
                    "type": "number"
                },
                "service": {
                    "description": "Service name (resolved from KPI if applicable, otherwise service identifier)",
                    "type": "string"
                },
                "serviceUuid": {
                    "description": "ServiceUUID is the original UUID if Service was resolved from a KPI",
                    "type": "string"
                },
                "summary": {
                    "description": "Summary explanation",
                    "type": "string"
                },
                "timeEnd": {
                    "description": "TimeEnd of the anomaly window",
                    "type": "string"
                },
                "timeStart": {
                    "description": "TimeStart when this anomaly was detected",
                    "type": "string"
                },
                "whyIndex": {
                    "description": "Why index in the chain (1 = most user-facing)",
                    "type": "integer"
                }
            }
        },
        "github_com_platformbuilds_mirador-core_internal_models.Threshold": {
            "type": "object",
            "properties": {
                "color": {
                    "description": "Display color",
                    "type": "string"
                },
                "description": {
                    "description": "Description of the threshold",
                    "type": "string"
                },
                "level": {
                    "description": "e.g., \"warning\", \"critical\"",
                    "type": "string"
                },
                "operator": {
                    "description": "e.g., \"gt\", \"lt\", \"eq\"",
                    "type": "string"
                },
                "value": {
                    "description": "Threshold value",
                    "type": "number"
                }
            }
        },
        "github_com_platformbuilds_mirador-core_internal_models.TimeRangeDTO": {
            "type": "object",
            "properties": {
                "endTime": {
                    "type": "string"
                },
                "startTime": {
                    "type": "string"
                }
            }
        },
        "github_com_platformbuilds_mirador-core_internal_models.TimeRingDefinitionDTO": {
            "type": "object",
            "properties": {
                "description": {
                    "type": "string"
                },
                "duration": {
                    "type": "string"
                },
                "label": {
                    "type": "string"
                }
            }
        },
        "github_com_platformbuilds_mirador-core_internal_models.TimeRingsDTO": {
            "type": "object",
            "properties": {
                "definitions": {
                    "type": "object",
                    "additionalProperties": {
                        "$ref": "#/definitions/github_com_platformbuilds_mirador-core_internal_models.TimeRingDefinitionDTO"
                    }
                },
                "perChain": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/github_com_platformbuilds_mirador-core_internal_models.TimeRingsPerChainDTO"
                    }
                }
            }
        },
        "github_com_platformbuilds_mirador-core_internal_models.TimeRingsPerChainDTO": {
            "type": "object",
            "properties": {
                "chainRank": {
                    "type": "integer"
                },
                "peakTime": {
                    "type": "string"
                },
                "rings": {
                    "type": "object",
                    "additionalProperties": {
                        "$ref": "#/definitions/github_com_platformbuilds_mirador-core_internal_models.TimeRangeDTO"
                    }
                },
                "windowEnd": {
                    "type": "string"
                },
                "windowStart": {
                    "type": "string"
                }
            }
        },
        "internal_api_handlers.MIRARCARequest": {
            "type": "object",
            "required": [
                "rcaData"
            ],
            "properties": {
                "rcaData": {
                    "$ref": "#/definitions/github_com_platformbuilds_mirador-core_internal_models.RCAResponse"
                }
            }
        }
    },
    "externalDocs": {
        "description": "OpenAPI",
        "url": "https://swagger.io/resources/open-api/"
    }
}