{
  "openapi": "3.0.3",
  "info": {
    "title": "MIRADOR-CORE API",
    "description": "Advanced Observability Platform REST API",
    "version": "9.0.0",
    "contact": {
      "name": "PlatformBuilds Team",
      "email": "support@miradorstack.com"
    }
  },
  "servers": [
    {
      "url": "{scheme}://{host}{basePath}",
      "description": "Configurable server (edit variables in Swagger UI)",
      "variables": {
        "scheme": {
          "enum": [
            "http",
            "https"
          ],
          "default": "http"
        },
        "host": {
          "default": "127.0.0.1:8010",
          "description": "Hostname:port of mirador-core"
        },
        "basePath": {
          "default": "/api/v1",
          "description": "Base path for API routes (use \"/\" for root-only endpoints)"
        }
      }
    }
  ],
  "components": {
    "securitySchemes": {
      "BearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "description": "Session token from LDAP/AD or SSO"
      }
    },
    "schemas": {
      "SystemFracture": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "component": {
            "type": "string"
          },
          "fracture_type": {
            "type": "string",
            "enum": [
              "fatigue",
              "overload",
              "degradation"
            ]
          },
          "time_to_fracture": {
            "type": "integer"
          },
          "severity": {
            "type": "string",
            "enum": [
              "high",
              "medium",
              "low"
            ]
          },
          "probability": {
            "type": "number",
            "minimum": 0,
            "maximum": 1
          },
          "confidence": {
            "type": "number",
            "minimum": 0,
            "maximum": 1
          }
        }
      },
      "CorrelationResult": {
        "type": "object",
        "properties": {
          "correlation_id": {
            "type": "string"
          },
          "root_cause": {
            "type": "string"
          },
          "confidence": {
            "type": "number"
          },
          "red_anchors": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/RedAnchor"
            }
          }
        }
      },
      "RedAnchor": {
        "type": "object",
        "description": "Anomaly score pattern for RCA analysis",
        "properties": {
          "service": {
            "type": "string"
          },
          "metric": {
            "type": "string"
          },
          "anomaly_score": {
            "type": "number"
          },
          "threshold": {
            "type": "number"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time"
          },
          "data_type": {
            "type": "string",
            "enum": [
              "metrics",
              "logs",
              "traces"
            ]
          }
        }
      },
      "ServiceGraphRequest": {
        "type": "object",
        "required": [
          "start",
          "end"
        ],
        "properties": {
          "start": {
            "type": "string",
            "format": "date-time",
            "description": "Start of the evaluation window (RFC3339)"
          },
          "end": {
            "type": "string",
            "format": "date-time",
            "description": "End of the evaluation window (RFC3339)"
          },
          "client": {
            "type": "string",
            "description": "Optional client service filter"
          },
          "server": {
            "type": "string",
            "description": "Optional server service filter"
          },
          "connection_type": {
            "type": "string",
            "description": "Optional connection type filter (for example \"http\")"
          }
        }
      },
      "ServiceGraphLatency": {
        "type": "object",
        "properties": {
          "avg_ms": {
            "type": "number",
            "format": "double",
            "description": "Average latency in milliseconds over the selected window"
          }
        }
      },
      "ServiceGraphEdge": {
        "type": "object",
        "properties": {
          "source": {
            "type": "string",
            "description": "Client service emitting the request"
          },
          "target": {
            "type": "string",
            "description": "Server service handling the request"
          },
          "connection_type": {
            "type": "string",
            "description": "Connection type inferred by the servicegraph connector"
          },
          "call_count": {
            "type": "number",
            "format": "double",
            "description": "Total calls between the services over the window"
          },
          "call_rate": {
            "type": "number",
            "format": "double",
            "description": "Average calls per minute during the window"
          },
          "error_count": {
            "type": "number",
            "format": "double",
            "description": "Failed calls over the window"
          },
          "error_rate": {
            "type": "number",
            "format": "double",
            "description": "Percentage of failed calls over total calls"
          },
          "server_latency_ms": {
            "$ref": "#/components/schemas/ServiceGraphLatency"
          },
          "client_latency_ms": {
            "$ref": "#/components/schemas/ServiceGraphLatency"
          },
          "unpaired_spans": {
            "type": "number",
            "format": "double",
            "description": "Count of unpaired spans contributing to the edge"
          },
          "dropped_spans": {
            "type": "number",
            "format": "double",
            "description": "Count of dropped spans while building the edge"
          }
        }
      },
      "ServiceGraphWindow": {
        "type": "object",
        "properties": {
          "start": {
            "type": "string",
            "format": "date-time"
          },
          "end": {
            "type": "string",
            "format": "date-time"
          },
          "duration_seconds": {
            "type": "integer",
            "description": "Duration of the evaluation window in seconds"
          }
        }
      },
      "ServiceGraphResponse": {
        "type": "object",
        "properties": {
          "status": {
            "type": "string"
          },
          "generated_at": {
            "type": "string",
            "format": "date-time"
          },
          "window": {
            "$ref": "#/components/schemas/ServiceGraphWindow"
          },
          "edges": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ServiceGraphEdge"
            }
          }
        }
      },
      "FlameNode": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "value": {
            "type": "integer",
            "description": "Duration in ms"
          },
          "spanId": {
            "type": "string"
          },
          "service": {
            "type": "string"
          },
          "children": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/FlameNode"
            }
          }
        }
      },
      "MetricsQLFunctionRequest": {
        "type": "object",
        "properties": {
          "query": {
            "type": "string",
            "description": "The MetricsQL query expression to aggregate"
          },
          "params": {
            "type": "object",
            "description": "Optional parameters for the aggregate function (e.g., quantile value, k value for topk/bottomk)",
            "additionalProperties": true
          }
        },
        "required": [
          "query"
        ]
      },
      "MetricsQLFunctionRangeRequest": {
        "type": "object",
        "properties": {
          "query": {
            "type": "string",
            "description": "The MetricsQL query expression to aggregate"
          },
          "start": {
            "type": "string",
            "format": "date-time",
            "description": "Start time for the range query (RFC3339 format)"
          },
          "end": {
            "type": "string",
            "format": "date-time",
            "description": "End time for the range query (RFC3339 format)"
          },
          "step": {
            "type": "string",
            "description": "Step duration for the range query (e.g., \"15s\", \"1m\", \"1h\")"
          },
          "params": {
            "type": "object",
            "description": "Optional parameters for the aggregate function (e.g., quantile value, k value for topk/bottomk)",
            "additionalProperties": true
          }
        },
        "required": [
          "query",
          "start",
          "end",
          "step"
        ]
      },
      "MetricsQLQueryResponse": {
        "type": "object",
        "properties": {
          "status": {
            "type": "string",
            "enum": [
              "success",
              "error"
            ]
          },
          "data": {
            "type": "object",
            "properties": {
              "result": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "metric": {
                      "type": "object",
                      "additionalProperties": true
                    },
                    "value": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      },
                      "description": "Array containing [timestamp, value] pair"
                    }
                  }
                }
              },
              "resultType": {
                "type": "string",
                "enum": [
                  "vector",
                  "matrix",
                  "scalar",
                  "string"
                ]
              }
            }
          },
          "error": {
            "type": "string",
            "description": "Error message if status is 'error'"
          },
          "errorType": {
            "type": "string",
            "description": "Type of error if status is 'error'"
          }
        }
      },
      "SchemaDefinition": {
        "type": "object",
        "required": [
          "id",
          "type",
          "name",
          "extensions",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique identifier for the schema definition"
          },
          "type": {
            "type": "string",
            "enum": [
              "metric",
              "label",
              "log_field",
              "trace_service",
              "trace_operation",
              "kpi",
              "dashboard",
              "layout",
              "user_preferences"
            ],
            "description": "The type of schema definition"
          },
          "name": {
            "type": "string",
            "description": "Human-readable name for the definition"
          },
          "description": {
            "type": "string",
            "description": "Optional description"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Flat array of tags (e.g., [\"domain:web\", \"category:performance\"])"
          },
          "author": {
            "type": "string",
            "description": "Author of the change"
          },
          "extensions": {
            "type": "object",
            "description": "Type-specific extension fields",
            "additionalProperties": true,
            "oneOf": [
              {
                "$ref": "#/components/schemas/MetricExtension"
              },
              {
                "$ref": "#/components/schemas/LabelExtension"
              },
              {
                "$ref": "#/components/schemas/LogFieldExtension"
              },
              {
                "$ref": "#/components/schemas/TraceServiceExtension"
              },
              {
                "$ref": "#/components/schemas/TraceOperationExtension"
              },
              {
                "$ref": "#/components/schemas/KPIExtension"
              },
              {
                "$ref": "#/components/schemas/DashboardExtension"
              },
              {
                "$ref": "#/components/schemas/LayoutExtension"
              },
              {
                "$ref": "#/components/schemas/UserPreferencesExtension"
              }
            ]
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "Last update timestamp"
          }
        }
      },
      "SchemaDefinitionResponse": {
        "type": "object",
        "required": [
          "schemaDefinition"
        ],
        "properties": {
          "schemaDefinition": {
            "$ref": "#/components/schemas/SchemaDefinition"
          }
        }
      },
      "MetricExtension": {
        "type": "object",
        "properties": {
          "description": {
            "type": "string",
            "description": "Metric description"
          },
          "owner": {
            "type": "string",
            "description": "Team or person responsible for the metric"
          },
          "unit": {
            "type": "string",
            "description": "Unit of measurement (e.g., \"requests\", \"bytes\", \"seconds\")"
          }
        }
      },
      "LabelExtension": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "string",
              "number",
              "boolean"
            ],
            "description": "Data type of the label"
          },
          "required": {
            "type": "boolean",
            "description": "Whether the label is required",
            "default": false
          },
          "allowed_values": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Allowed values for the label"
          },
          "description": {
            "type": "string",
            "description": "Label description"
          }
        }
      },
      "LogFieldExtension": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "string",
              "number",
              "boolean",
              "object"
            ],
            "description": "Data type of the log field"
          },
          "indexed": {
            "type": "boolean",
            "description": "Whether the field is indexed for search",
            "default": false
          },
          "description": {
            "type": "string",
            "description": "Field description"
          },
          "examples": {
            "type": "object",
            "additionalProperties": {
              "type": "string"
            },
            "description": "Example values"
          }
        }
      },
      "TraceServiceExtension": {
        "type": "object",
        "properties": {
          "purpose": {
            "type": "string",
            "description": "Service purpose/description"
          },
          "owner": {
            "type": "string",
            "description": "Team or person responsible for the service"
          },
          "language": {
            "type": "string",
            "description": "Programming language (e.g., \"go\", \"java\", \"python\")"
          }
        }
      },
      "TraceOperationExtension": {
        "type": "object",
        "properties": {
          "service": {
            "type": "string",
            "description": "Associated service name"
          },
          "purpose": {
            "type": "string",
            "description": "Operation purpose/description"
          },
          "method": {
            "type": "string",
            "description": "HTTP method or operation type"
          },
          "endpoint": {
            "type": "string",
            "description": "API endpoint or operation path"
          }
        }
      },
      "KPIExtension": {
        "type": "object",
        "properties": {
          "kind": {
            "type": "string",
            "enum": [
              "percentage",
              "number",
              "duration",
              "bytes"
            ],
            "description": "KPI data type"
          },
          "unit": {
            "type": "string",
            "description": "Unit of measurement"
          },
          "format": {
            "type": "string",
            "description": "Display format (e.g., \"0.00\", \"0.0%\")"
          },
          "query": {
            "type": "string",
            "description": "MetricsQL query for KPI calculation"
          },
          "thresholds": {
            "type": "object",
            "properties": {
              "warning": {
                "type": "number",
                "description": "Warning threshold value"
              },
              "critical": {
                "type": "number",
                "description": "Critical threshold value"
              }
            }
          },
          "sparkline": {
            "type": "boolean",
            "description": "Whether to show sparkline chart",
            "default": true
          },
          "visibility": {
            "type": "string",
            "enum": [
              "public",
              "private",
              "team"
            ],
            "description": "KPI visibility level",
            "default": "public"
          }
        }
      },
      "DashboardExtension": {
        "type": "object",
        "properties": {
          "layout": {
            "type": "string",
            "description": "Dashboard layout configuration"
          },
          "widgets": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "type": {
                  "type": "string",
                  "description": "Widget type"
                },
                "config": {
                  "type": "object",
                  "additionalProperties": true,
                  "description": "Widget configuration"
                }
              }
            }
          },
          "refresh_interval": {
            "type": "string",
            "description": "Auto-refresh interval (e.g., \"30s\", \"5m\")"
          }
        }
      },
      "LayoutExtension": {
        "type": "object",
        "properties": {
          "grid": {
            "type": "object",
            "properties": {
              "columns": {
                "type": "integer",
                "description": "Number of grid columns"
              },
              "rows": {
                "type": "integer",
                "description": "Number of grid rows"
              }
            }
          },
          "widgets": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "id": {
                  "type": "string",
                  "description": "Widget ID"
                },
                "position": {
                  "type": "object",
                  "properties": {
                    "x": {
                      "type": "integer"
                    },
                    "y": {
                      "type": "integer"
                    },
                    "width": {
                      "type": "integer"
                    },
                    "height": {
                      "type": "integer"
                    }
                  }
                },
                "config": {
                  "type": "object",
                  "additionalProperties": true
                }
              }
            }
          }
        }
      },
      "UserPreferencesExtension": {
        "type": "object",
        "properties": {
          "theme": {
            "type": "string",
            "enum": [
              "light",
              "dark",
              "auto"
            ],
            "description": "UI theme preference"
          },
          "timezone": {
            "type": "string",
            "description": "Preferred timezone"
          },
          "date_format": {
            "type": "string",
            "description": "Preferred date format"
          },
          "notifications": {
            "type": "object",
            "properties": {
              "enabled": {
                "type": "boolean",
                "default": true
              },
              "channels": {
                "type": "array",
                "items": {
                  "type": "string",
                  "enum": [
                    "email",
                    "slack",
                    "webhook"
                  ]
                }
              }
            }
          },
          "dashboard_defaults": {
            "type": "object",
            "additionalProperties": true,
            "description": "Default dashboard settings"
          }
        }
      },
      "GRPCEndpointsConfig": {
        "type": "object",
        "properties": {
          "rca_endpoint": {
            "type": "string",
            "description": "Endpoint URL for the RCA (Root Cause Analysis) gRPC service",
            "example": "rca-service:50051"
          },
          "alerts_endpoint": {
            "type": "string",
            "description": "Endpoint URL for the ALERTS gRPC service",
            "example": "alerts-service:50053"
          }
        }
      },
      "GRPCEndpointsUpdateRequest": {
        "type": "object",
        "properties": {
          "rca_endpoint": {
            "type": "string",
            "description": "New endpoint URL for the RCA gRPC service",
            "example": "rca-service-new:50051"
          },
          "alerts_endpoint": {
            "type": "string",
            "description": "New endpoint URL for the ALERTS gRPC service",
            "example": "alerts-service-new:50053"
          }
        },
        "additionalProperties": false,
        "description": "At least one endpoint must be provided for update"
      },
      "UnifiedQueryRequest": {
        "type": "object",
        "required": [
          "query"
        ],
        "properties": {
          "query": {
            "$ref": "#/components/schemas/UnifiedQuery"
          }
        },
        "description": "Request wrapper for unified queries"
      },
      "UnifiedQueryResponse": {
        "type": "object",
        "required": [
          "result"
        ],
        "properties": {
          "result": {
            "$ref": "#/components/schemas/UnifiedResult"
          }
        },
        "description": "Response wrapper for unified query results"
      },
      "UnifiedQuery": {
        "type": "object",
        "required": [
          "id",
          "type",
          "query"
        ],
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique identifier for the query",
            "example": "query-123"
          },
          "type": {
            "type": "string",
            "enum": [
              "metrics",
              "logs",
              "traces",
              "correlation"
            ],
            "description": "Type of query to execute",
            "example": "metrics"
          },
          "query": {
            "type": "string",
            "description": "Query string in appropriate syntax for the query type",
            "example": "http_requests_total{job=\"api\"}"
          },
          "tenant_id": {
            "type": "string",
            "description": "Optional tenant identifier",
            "example": "tenant-abc"
          },
          "start_time": {
            "type": "string",
            "format": "date-time",
            "description": "Start time for time-bounded queries"
          },
          "end_time": {
            "type": "string",
            "format": "date-time",
            "description": "End time for time-bounded queries"
          },
          "timeout": {
            "type": "string",
            "description": "Query timeout duration",
            "example": "30s"
          },
          "parameters": {
            "type": "object",
            "additionalProperties": true,
            "description": "Engine-specific query parameters"
          },
          "correlation_options": {
            "$ref": "#/components/schemas/CorrelationOptions"
          },
          "cache_options": {
            "$ref": "#/components/schemas/CacheOptions"
          }
        }
      },
      "CorrelationOptions": {
        "type": "object",
        "properties": {
          "enabled": {
            "type": "boolean",
            "description": "Whether correlation is enabled",
            "default": false
          },
          "correlation_keys": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Keys to correlate across engines",
            "example": [
              "service",
              "instance"
            ]
          },
          "time_window": {
            "type": "string",
            "description": "Time window for correlation",
            "example": "5m"
          },
          "engines": {
            "type": "array",
            "items": {
              "type": "string",
              "enum": [
                "metrics",
                "logs",
                "traces"
              ]
            },
            "description": "Engines to include in correlation"
          },
          "filters": {
            "type": "object",
            "additionalProperties": true,
            "description": "Additional correlation filters"
          }
        }
      },
      "CacheOptions": {
        "type": "object",
        "properties": {
          "enabled": {
            "type": "boolean",
            "description": "Whether caching is enabled",
            "default": true
          },
          "ttl": {
            "type": "string",
            "description": "Cache TTL duration",
            "example": "5m"
          },
          "key": {
            "type": "string",
            "description": "Custom cache key"
          },
          "bypass_cache": {
            "type": "boolean",
            "description": "Force fresh query execution",
            "default": false
          }
        }
      },
      "UnifiedResult": {
        "type": "object",
        "required": [
          "query_id",
          "type",
          "status"
        ],
        "properties": {
          "query_id": {
            "type": "string",
            "description": "ID of the executed query"
          },
          "type": {
            "type": "string",
            "enum": [
              "metrics",
              "logs",
              "traces",
              "correlation"
            ],
            "description": "Type of result"
          },
          "status": {
            "type": "string",
            "enum": [
              "success",
              "error",
              "partial"
            ],
            "description": "Execution status"
          },
          "data": {
            "description": "Query result data (structure varies by query type)"
          },
          "metadata": {
            "$ref": "#/components/schemas/ResultMetadata"
          },
          "correlations": {
            "$ref": "#/components/schemas/UnifiedCorrelationResult"
          },
          "execution_time_ms": {
            "type": "integer",
            "format": "int64",
            "description": "Query execution time in milliseconds"
          },
          "cached": {
            "type": "boolean",
            "description": "Whether result came from cache"
          }
        }
      },
      "ResultMetadata": {
        "type": "object",
        "properties": {
          "engine_results": {
            "type": "object",
            "additionalProperties": {
              "$ref": "#/components/schemas/EngineResult"
            },
            "description": "Results from individual engines"
          },
          "total_records": {
            "type": "integer",
            "description": "Total number of records returned"
          },
          "data_sources": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Data sources that contributed to the result"
          },
          "warnings": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Non-fatal warnings during execution"
          }
        }
      },
      "EngineResult": {
        "type": "object",
        "required": [
          "engine",
          "status"
        ],
        "properties": {
          "engine": {
            "type": "string",
            "enum": [
              "metrics",
              "logs",
              "traces",
              "correlation"
            ],
            "description": "Engine that produced this result"
          },
          "status": {
            "type": "string",
            "enum": [
              "success",
              "error",
              "partial"
            ],
            "description": "Status of this engine's execution"
          },
          "record_count": {
            "type": "integer",
            "description": "Number of records from this engine"
          },
          "execution_time_ms": {
            "type": "integer",
            "format": "int64",
            "description": "Execution time for this engine"
          },
          "error": {
            "type": "string",
            "description": "Error message if status is error"
          },
          "data_source": {
            "type": "string",
            "description": "Specific data source used by this engine"
          }
        }
      },
      "UnifiedCorrelationResult": {
        "type": "object",
        "required": [
          "correlations",
          "summary"
        ],
        "properties": {
          "correlations": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Correlation"
            },
            "description": "Individual correlations found"
          },
          "summary": {
            "$ref": "#/components/schemas/CorrelationSummary"
          }
        }
      },
      "Correlation": {
        "type": "object",
        "required": [
          "id",
          "correlation_key",
          "timestamp"
        ],
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique correlation identifier"
          },
          "correlation_key": {
            "type": "string",
            "description": "Key used for correlation"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "description": "Timestamp of the correlation"
          },
          "engines": {
            "type": "object",
            "additionalProperties": true,
            "description": "Data from each correlated engine"
          },
          "confidence": {
            "type": "number",
            "minimum": 0,
            "maximum": 1,
            "description": "Confidence score of the correlation"
          },
          "metadata": {
            "type": "object",
            "additionalProperties": true,
            "description": "Additional correlation metadata"
          }
        }
      },
      "CorrelationSummary": {
        "type": "object",
        "required": [
          "total_correlations",
          "average_confidence",
          "time_range",
          "engines_involved"
        ],
        "properties": {
          "total_correlations": {
            "type": "integer",
            "description": "Total number of correlations found"
          },
          "average_confidence": {
            "type": "number",
            "minimum": 0,
            "maximum": 1,
            "description": "Average confidence across all correlations"
          },
          "time_range": {
            "type": "string",
            "description": "Time range covered by correlations"
          },
          "engines_involved": {
            "type": "array",
            "items": {
              "type": "string",
              "enum": [
                "metrics",
                "logs",
                "traces"
              ]
            },
            "description": "Engines that participated in correlations"
          }
        }
      },
      "QueryMetadata": {
        "type": "object",
        "required": [
          "supported_engines",
          "query_capabilities",
          "cache_capabilities"
        ],
        "properties": {
          "supported_engines": {
            "type": "array",
            "items": {
              "type": "string",
              "enum": [
                "metrics",
                "logs",
                "traces",
                "correlation"
              ]
            },
            "description": "Engines supported by the unified query system"
          },
          "query_capabilities": {
            "type": "object",
            "additionalProperties": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "description": "Query capabilities per engine type"
          },
          "cache_capabilities": {
            "$ref": "#/components/schemas/CacheCapabilities"
          }
        }
      },
      "CacheCapabilities": {
        "type": "object",
        "required": [
          "supported"
        ],
        "properties": {
          "supported": {
            "type": "boolean",
            "description": "Whether caching is supported"
          },
          "default_ttl": {
            "type": "string",
            "description": "Default cache TTL",
            "example": "5m"
          },
          "max_ttl": {
            "type": "string",
            "description": "Maximum allowed cache TTL",
            "example": "1h"
          }
        }
      },
      "EngineHealthStatus": {
        "type": "object",
        "required": [
          "overall_health",
          "engine_health",
          "last_checked"
        ],
        "properties": {
          "overall_health": {
            "type": "string",
            "enum": [
              "healthy",
              "unhealthy",
              "partial"
            ],
            "description": "Overall health status of all engines"
          },
          "engine_health": {
            "type": "object",
            "additionalProperties": {
              "type": "string"
            },
            "description": "Health status per engine",
            "example": {
              "metrics": "healthy",
              "logs": "healthy",
              "traces": "unhealthy"
            }
          },
          "last_checked": {
            "type": "string",
            "format": "date-time",
            "description": "Timestamp of last health check"
          }
        }
      }
    }
  },
  "security": [
    {
      "BearerAuth": []
    }
  ],
  "paths": {
    "/health": {
      "get": {
        "tags": [
          "health"
        ],
        "summary": "Health check",
        "description": "Returns basic service health",
        "responses": {
          "200": {
            "description": "Healthy"
          }
        }
      }
    },
    "/ready": {
      "get": {
        "tags": [
          "health"
        ],
        "summary": "Readiness check",
        "description": "Checks backends (Victoria*, engines) and returns readiness",
        "responses": {
          "200": {
            "description": "Ready"
          },
          "503": {
            "description": "Not ready"
          }
        }
      }
    },
    "/microservices/status": {
      "get": {
        "tags": [
          "health"
        ],
        "summary": "Microservices status",
        "description": "Returns detailed status of all microservices",
        "responses": {
          "200": {
            "description": "Microservices status"
          }
        }
      }
    },
    "/metrics": {
      "get": {
        "tags": [
          "metrics"
        ],
        "summary": "Prometheus metrics",
        "description": "Exposes Prometheus metrics for monitoring",
        "responses": {
          "200": {
            "description": "Prometheus metrics data"
          }
        }
      },
      "post": {
        "summary": "Analyze system fractures",
        "description": "Predict possible fracture/fatigue in running services",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "component": {
                    "type": "string"
                  },
                  "time_range": {
                    "type": "string"
                  },
                  "model_types": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Fracture analysis results",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "fractures": {
                          "type": "array",
                          "items": {
                            "$ref": "#/components/schemas/SystemFracture"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/rca/investigate": {
      "post": {
        "tags": [
          "rca"
        ],
        "summary": "Start RCA investigation",
        "description": "Correlate incidents using red anchors pattern across metrics, logs, traces",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "incident_id": {
                    "type": "string"
                  },
                  "symptoms": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  },
                  "time_range": {
                    "type": "object",
                    "properties": {
                      "start": {
                        "type": "string",
                        "format": "date-time"
                      },
                      "end": {
                        "type": "string",
                        "format": "date-time"
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "RCA correlation results",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CorrelationResult"
                }
              }
            }
          }
        }
      }
    },
    "/kpi/{type}": {
      "post": {
        "tags": [
          "kpi"
        ],
        "summary": "Create or update KPI definition",
        "description": "Create or update a KPI definition of the specified type. KPIs serve as the central schema definitions,\nsupporting metrics, labels, log fields, traces, dashboards, layouts, and user preferences.\n",
        "parameters": [
          {
            "in": "path",
            "name": "type",
            "required": true,
            "schema": {
              "type": "string",
              "enum": [
                "metric",
                "label",
                "log_field",
                "trace_service",
                "trace_operation",
                "kpi",
                "dashboard",
                "layout",
                "user_preferences"
              ]
            },
            "description": "The type of KPI definition"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Human-readable name for the definition"
                  },
                  "description": {
                    "type": "string",
                    "description": "Optional description"
                  },
                  "tags": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "description": "Flat array of tags (e.g., [\"domain:web\", \"category:performance\"])"
                  },
                  "author": {
                    "type": "string",
                    "description": "Author of the change"
                  },
                  "extensions": {
                    "type": "object",
                    "description": "Type-specific extension fields",
                    "additionalProperties": true
                  }
                }
              },
              "examples": {
                "metric": {
                  "summary": "Create metric definition",
                  "value": {
                    "name": "http_requests_total",
                    "description": "Total number of HTTP requests",
                    "tags": [
                      "domain:web",
                      "category:performance"
                    ],
                    "author": "john.doe",
                    "extensions": {
                      "metric": {
                        "description": "Total number of HTTP requests",
                        "owner": "platform-team"
                      }
                    }
                  }
                },
                "label": {
                  "summary": "Create label definition",
                  "value": {
                    "name": "status",
                    "tags": [
                      "category:monitoring",
                      "indexed:true"
                    ],
                    "author": "jane.smith",
                    "extensions": {
                      "label": {
                        "type": "string",
                        "required": false,
                        "allowedVals": [
                          "success",
                          "error",
                          "warning"
                        ],
                        "description": "Request status"
                      }
                    }
                  }
                },
                "kpi": {
                  "summary": "Create KPI definition",
                  "value": {
                    "name": "Error Rate",
                    "tags": [
                      "domain:api",
                      "category:reliability"
                    ],
                    "author": "ops.team",
                    "extensions": {
                      "kpi": {
                        "kind": "percentage",
                        "unit": "%",
                        "format": "0.00",
                        "query": "rate(errors_total[5m]) / rate(http_requests_total[5m]) * 100",
                        "thresholds": {
                          "warning": 5.0,
                          "critical": 10.0
                        },
                        "sparkline": true,
                        "visibility": "public"
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "KPI definition created/updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "ok"
                    },
                    "id": {
                      "type": "string",
                      "description": "Unique identifier of the created/updated definition"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid request format or unsupported schema type"
          },
          "500": {
            "description": "Internal server error"
          }
        }
      },
      "get": {
        "tags": [
          "kpi"
        ],
        "summary": "List KPI definitions",
        "description": "List KPI definitions of the specified type with optional filtering and pagination.",
        "parameters": [
          {
            "in": "path",
            "name": "type",
            "required": true,
            "schema": {
              "type": "string",
              "enum": [
                "metric",
                "label",
                "log_field",
                "trace_service",
                "trace_operation",
                "kpi",
                "dashboard",
                "layout",
                "user_preferences"
              ]
            },
            "description": "The type of KPI definitions to list"
          },
          {
            "in": "query",
            "name": "limit",
            "schema": {
              "type": "integer",
              "minimum": 1,
              "maximum": 1000,
              "default": 50
            },
            "description": "Maximum number of results to return"
          },
          {
            "in": "query",
            "name": "offset",
            "schema": {
              "type": "integer",
              "minimum": 0,
              "default": 0
            },
            "description": "Pagination offset"
          },
          {
            "in": "query",
            "name": "tags",
            "schema": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "style": "form",
            "explode": true,
            "description": "Filter by tags (comma-separated)"
          }
        ],
        "responses": {
          "200": {
            "description": "KPI definitions retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "schemaDefinitions": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/SchemaDefinition"
                      }
                    },
                    "total": {
                      "type": "integer",
                      "description": "Total number of definitions available"
                    },
                    "nextOffset": {
                      "type": "integer",
                      "description": "Offset for next page (0 if no more results)"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters or unsupported schema type"
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/schema/{type}/{id}": {
      "get": {
        "tags": [
          "kpi"
        ],
        "summary": "Get KPI definition by ID",
        "description": "Retrieve a specific KPI definition by its type and ID.",
        "parameters": [
          {
            "in": "path",
            "name": "type",
            "required": true,
            "schema": {
              "type": "string",
              "enum": [
                "metric",
                "label",
                "log_field",
                "trace_service",
                "trace_operation",
                "kpi",
                "dashboard",
                "layout",
                "user_preferences"
              ]
            },
            "description": "The type of KPI definition"
          },
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Unique identifier of the schema definition"
          }
        ],
        "responses": {
          "200": {
            "description": "KPI definition retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SchemaDefinitionResponse"
                }
              }
            }
          },
          "404": {
            "description": "KPI definition not found"
          },
          "400": {
            "description": "Invalid request parameters or unsupported schema type"
          },
          "500": {
            "description": "Internal server error"
          }
        }
      },
      "delete": {
        "tags": [
          "kpi"
        ],
        "summary": "Delete KPI definition",
        "description": "Delete a KPI definition by its type and ID. Requires confirmation via query parameter.",
        "parameters": [
          {
            "in": "path",
            "name": "type",
            "required": true,
            "schema": {
              "type": "string",
              "enum": [
                "metric",
                "label",
                "log_field",
                "trace_service",
                "trace_operation",
                "kpi",
                "dashboard",
                "layout",
                "user_preferences"
              ]
            },
            "description": "The type of KPI definition"
          },
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Unique identifier of the KPI definition"
          },
          {
            "in": "query",
            "name": "confirm",
            "required": true,
            "schema": {
              "type": "string",
              "enum": [
                "1",
                "true",
                "yes"
              ]
            },
            "description": "Confirmation required for deletion"
          }
        ],
        "responses": {
          "200": {
            "description": "KPI definition deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "deleted"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Missing confirmation or invalid parameters"
          },
          "404": {
            "description": "KPI definition not found"
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/schema/{type}/bulk": {
      "post": {
        "tags": [
          "kpi"
        ],
        "summary": "Bulk upload KPI definitions via CSV",
        "description": "Upload multiple KPI definitions via CSV file. Supports secure file handling with size limits,\nMIME validation, and CSV injection protection.\n",
        "parameters": [
          {
            "in": "path",
            "name": "type",
            "required": true,
            "schema": {
              "type": "string",
              "enum": [
                "metric",
                "label",
                "log_field",
                "trace_service",
                "trace_operation",
                "kpi",
                "dashboard",
                "layout",
                "user_preferences"
              ]
            },
            "description": "The type of KPI definitions to upload"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "required": [
                  "file"
                ],
                "properties": {
                  "file": {
                    "type": "string",
                    "format": "binary",
                    "description": "CSV file containing KPI definitions"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Bulk upload completed successfully"
          },
          "400": {
            "description": "Invalid CSV format or data validation errors"
          },
          "413": {
            "description": "File too large (exceeds 5MiB limit)"
          },
          "429": {
            "description": "Rate limit exceeded for bulk uploads"
          },
          "500": {
            "description": "Internal server error during processing"
          }
        }
      }
    },
    "/schema/{type}/bulk/sample": {
      "get": {
        "tags": [
          "kpi"
        ],
        "summary": "Download CSV template for bulk KPI upload",
        "description": "Download a sample CSV template with headers and example rows for bulk KPI definition uploads.",
        "parameters": [
          {
            "in": "path",
            "name": "type",
            "required": true,
            "schema": {
              "type": "string",
              "enum": [
                "metric",
                "label",
                "log_field",
                "trace_service",
                "trace_operation",
                "kpi",
                "dashboard",
                "layout",
                "user_preferences"
              ]
            },
            "description": "The type of KPI definitions for the template"
          }
        ],
        "responses": {
          "200": {
            "description": "CSV template downloaded successfully",
            "content": {
              "text/csv": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              }
            }
          },
          "400": {
            "description": "Unsupported KPI type"
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/rca/correlations": {
      "get": {
        "tags": [
          "rca"
        ],
        "summary": "Get active correlations",
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/rca/patterns": {
      "get": {
        "tags": [
          "rca"
        ],
        "summary": "Get failure patterns",
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/rca/service-graph": {
      "post": {
        "tags": [
          "rca"
        ],
        "summary": "Aggregate service graph metrics",
        "description": "Aggregates OpenTelemetry service graph metrics emitted by the\n`servicegraph` connector across every configured VictoriaMetrics source\nand returns the directed dependency edges for the requested window.\n",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ServiceGraphRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Service graph edges",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ServiceGraphResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "500": {
            "description": "Failed to fetch service graph"
          }
        }
      }
    },
    "/rca/store": {
      "post": {
        "tags": [
          "rca"
        ],
        "summary": "Store correlation event",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/metrics/names": {
      "get": {
        "tags": [
          "metrics"
        ],
        "summary": "List metric names",
        "description": "Returns values of the special label `__name__` from VictoriaMetrics.",
        "parameters": [
          {
            "in": "query",
            "name": "start",
            "schema": {
              "type": "string"
            },
            "description": "Start time (RFC3339 or unix seconds)"
          },
          {
            "in": "query",
            "name": "end",
            "schema": {
              "type": "string"
            },
            "description": "End time (RFC3339 or unix seconds)"
          },
          {
            "in": "query",
            "name": "match[]",
            "schema": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "style": "form",
            "explode": true,
            "description": "Optional label matchers"
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/metrics/series": {
      "get": {
        "tags": [
          "metrics"
        ],
        "summary": "Series listing",
        "description": "Returns a list of all time series that match the specified PromQL selectors.",
        "parameters": [
          {
            "in": "query",
            "name": "match[]",
            "schema": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "style": "form",
            "explode": true,
            "description": "PromQL series selectors to filter time series"
          },
          {
            "in": "query",
            "name": "start",
            "schema": {
              "type": "string"
            },
            "description": "Start time (RFC3339 or unix seconds)"
          },
          {
            "in": "query",
            "name": "end",
            "schema": {
              "type": "string"
            },
            "description": "End time (RFC3339 or unix seconds)"
          }
        ],
        "responses": {
          "200": {
            "description": "List of time series with their label sets",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "additionalProperties": {
                          "type": "string"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/metrics/labels": {
      "post": {
        "tags": [
          "metrics"
        ],
        "summary": "Labels listing for a specific metric",
        "description": "Returns a list of label names that exist for the specified metric.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "metric"
                ],
                "properties": {
                  "metric": {
                    "type": "string",
                    "description": "The metric name to get labels for"
                  },
                  "start": {
                    "type": "string",
                    "description": "Start time (RFC3339 or unix seconds)"
                  },
                  "end": {
                    "type": "string",
                    "description": "End time (RFC3339 or unix seconds)"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "List of label names",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/label/{name}/values": {
      "get": {
        "tags": [
          "metrics"
        ],
        "summary": "Label values",
        "parameters": [
          {
            "in": "path",
            "name": "name",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/metrics/query": {
      "post": {
        "tags": [
          "metrics"
        ],
        "summary": "MetricsQL instant query (VictoriaMetrics)",
        "description": "Executes an instant query against VictoriaMetrics using MetricsQL/PromQL syntax.\nWhen `include_definitions` is enabled (default), the response contains `definitions` sourced from the schema store\n(Weaviate) including metric and per-metric label definitions. Optional `label_keys` can limit which label keys are considered.\nWhen multiple metrics sources are configured in config.yaml (database.victoria_metrics + database.metrics_sources),\nthe server fans out the query across sources and aggregates the results. Identical series from different sources may appear as duplicates.\n",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  },
                  "time": {
                    "type": "string"
                  },
                  "include_definitions": {
                    "type": "boolean",
                    "description": "Include definitions in response (default true)"
                  },
                  "label_keys": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "description": "Restrict definitions to these label keys"
                  }
                }
              },
              "example": {
                "query": "http_requests_total{job=\"api\"}",
                "time": "2025-01-01T00:00:00Z"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/metrics/query_range": {
      "post": {
        "tags": [
          "metrics"
        ],
        "summary": "MetricsQL range query (VictoriaMetrics)",
        "description": "Executes a range query. When `include_definitions` is enabled (default), the response contains\n`definitions` for metrics and per-metric label keys. Use `label_keys` to limit keys.\nWhen multiple metrics sources are configured, the server fans out the query and concatenates series across sources; datapoint counts are aggregated.\n",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  },
                  "start": {
                    "type": "string"
                  },
                  "end": {
                    "type": "string"
                  },
                  "step": {
                    "type": "string"
                  },
                  "include_definitions": {
                    "type": "boolean",
                    "description": "Include definitions in response (default true)"
                  },
                  "label_keys": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "description": "Restrict definitions to these label keys"
                  }
                }
              },
              "example": {
                "query": "http_requests_total{job=\"api\"}",
                "start": "2025-01-01T00:00:00Z",
                "end": "2025-01-01T01:00:00Z",
                "step": "5m"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "example": {
                  "status": "success",
                  "data": {
                    "resultType": "matrix",
                    "result": [
                      {
                        "metric": {
                          "__name__": "http_requests_total",
                          "job": "api",
                          "instance": "pod-1"
                        },
                        "values": [
                          [
                            1690000000,
                            "1"
                          ],
                          [
                            1690000300,
                            "2"
                          ]
                        ]
                      }
                    ]
                  },
                  "metadata": {
                    "executionTime": 18,
                    "dataPoints": 2,
                    "timeRange": "1690000000 to 1690003600",
                    "step": 30
                  },
                  "definitions": {
                    "metrics": {
                      "http_requests_total": {
                        "description": "Total number of HTTP requests"
                      }
                    },
                    "labels": {
                      "http_requests_total": {
                        "instance": {
                          "type": "string",
                          "required": false
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/metrics/query/rollup/{function}": {
      "post": {
        "tags": [
          "metrics"
        ],
        "summary": "Execute MetricsQL rollup function",
        "description": "Executes a MetricsQL rollup function specified by the {function} path parameter. Supported functions include rate, increase, delta, irate, deriv, idelta, ideriv, absent_over_time, avg_over_time, min_over_time, max_over_time, sum_over_time, count_over_time, quantile_over_time, stddev_over_time, stdvar_over_time, mad_over_time, zscore_over_time, distinct_over_time, changes, resets, and more.",
        "parameters": [
          {
            "name": "function",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "enum": [
                "rate",
                "increase",
                "delta",
                "irate",
                "deriv",
                "idelta",
                "ideriv",
                "absent_over_time",
                "avg_over_time",
                "min_over_time",
                "max_over_time",
                "sum_over_time",
                "count_over_time",
                "quantile_over_time",
                "stddev_over_time",
                "stdvar_over_time",
                "mad_over_time",
                "zscore_over_time",
                "distinct_over_time",
                "changes",
                "resets",
                "rollup_candlestick"
              ]
            },
            "description": "The rollup function to execute"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/MetricsQLFunctionRequest"
              },
              "examples": {
                "rate_example": {
                  "summary": "Calculate request rate per second",
                  "value": {
                    "query": "rate(http_requests_total[5m])"
                  }
                },
                "quantile_example": {
                  "summary": "Calculate 95th percentile over time",
                  "value": {
                    "query": "quantile_over_time(0.95, http_requests_total[1h])"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Rollup function result",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MetricsQLQueryResponse"
                }
              }
            }
          }
        }
      }
    },
    "/metrics/query/rollup/{function}/range": {
      "post": {
        "tags": [
          "metrics"
        ],
        "summary": "Execute MetricsQL rollup function (range)",
        "description": "Executes a MetricsQL rollup function over a time range specified by the {function} path parameter. Supported functions include rate, increase, delta, irate, deriv, idelta, ideriv, absent_over_time, avg_over_time, min_over_time, max_over_time, sum_over_time, count_over_time, quantile_over_time, stddev_over_time, stdvar_over_time, mad_over_time, zscore_over_time, distinct_over_time, changes, resets, and more.",
        "parameters": [
          {
            "name": "function",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "enum": [
                "rate",
                "increase",
                "delta",
                "irate",
                "deriv",
                "idelta",
                "ideriv",
                "absent_over_time",
                "avg_over_time",
                "min_over_time",
                "max_over_time",
                "sum_over_time",
                "count_over_time",
                "quantile_over_time",
                "stddev_over_time",
                "stdvar_over_time",
                "mad_over_time",
                "zscore_over_time",
                "distinct_over_time",
                "changes",
                "resets",
                "rollup_candlestick"
              ]
            },
            "description": "The rollup function to execute"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/MetricsQLFunctionRangeRequest"
              },
              "examples": {
                "rate_range_example": {
                  "summary": "Calculate request rate per second over time range",
                  "value": {
                    "query": "rate(http_requests_total[5m])",
                    "start": "2025-01-01T00:00:00Z",
                    "end": "2025-01-01T01:00:00Z",
                    "step": "1m"
                  }
                },
                "quantile_range_example": {
                  "summary": "Calculate 95th percentile over time range",
                  "value": {
                    "query": "quantile_over_time(0.95, http_requests_total[1h])",
                    "start": "2025-01-01T00:00:00Z",
                    "end": "2025-01-01T01:00:00Z",
                    "step": "5m"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Rollup function result",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MetricsQLQueryResponse"
                }
              }
            }
          }
        }
      }
    },
    "/metrics/query/transform/{function}": {
      "post": {
        "tags": [
          "metrics"
        ],
        "summary": "Execute MetricsQL transform function",
        "description": "Executes a MetricsQL transform function specified by the {function} path parameter. Supported functions include abs, absent, ceil, clamp, clamp_max, clamp_min, day_of_month, day_of_week, days_in_month, deg, exp, floor, histogram_quantile, hour, ln, log10, log2, minute, month, pi, rad, rate, round, scalar, sgn, sin, sqrt, tan, time, timestamp, vector, year, and more.",
        "parameters": [
          {
            "name": "function",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "enum": [
                "abs",
                "absent",
                "ceil",
                "clamp",
                "clamp_max",
                "clamp_min",
                "day_of_month",
                "day_of_week",
                "days_in_month",
                "deg",
                "exp",
                "floor",
                "histogram_quantile",
                "hour",
                "ln",
                "log10",
                "log2",
                "minute",
                "month",
                "pi",
                "rad",
                "rate",
                "round",
                "scalar",
                "sgn",
                "sin",
                "sqrt",
                "tan",
                "time",
                "timestamp",
                "vector",
                "year",
                "label_replace",
                "label_join",
                "label_set",
                "label_keep",
                "label_drop",
                "label_match",
                "label_mismatch"
              ]
            },
            "description": "The transform function to execute"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/MetricsQLFunctionRequest"
              },
              "examples": {
                "round_example": {
                  "summary": "Round values to nearest integer",
                  "value": {
                    "query": "round(http_requests_total)"
                  }
                },
                "clamp_example": {
                  "summary": "Clamp values between min and max",
                  "value": {
                    "query": "clamp(http_requests_total, 0, 100)",
                    "params": {
                      "min": 0,
                      "max": 100
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Transform function result",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MetricsQLQueryResponse"
                }
              }
            }
          }
        }
      }
    },
    "/metrics/query/transform/{function}/range": {
      "post": {
        "tags": [
          "metrics"
        ],
        "summary": "Execute MetricsQL transform function (range)",
        "description": "Executes a MetricsQL transform function over a time range specified by the {function} path parameter. Supported functions include abs, absent, ceil, clamp, clamp_max, clamp_min, day_of_month, day_of_week, days_in_month, deg, exp, floor, histogram_quantile, hour, ln, log10, log2, minute, month, pi, rad, rate, round, scalar, sgn, sin, sqrt, tan, time, timestamp, vector, year, label_replace, label_join, label_set, label_keep, label_drop, label_match, label_mismatch]",
        "parameters": [
          {
            "name": "function",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "enum": [
                "abs",
                "absent",
                "ceil",
                "clamp",
                "clamp_max",
                "clamp_min",
                "day_of_month",
                "day_of_week",
                "days_in_month",
                "deg",
                "exp",
                "floor",
                "histogram_quantile",
                "hour",
                "ln",
                "log10",
                "log2",
                "minute",
                "month",
                "pi",
                "rad",
                "rate",
                "round",
                "scalar",
                "sgn",
                "sin",
                "sqrt",
                "tan",
                "time",
                "timestamp",
                "vector",
                "year",
                "label_replace",
                "label_join",
                "label_set",
                "label_keep",
                "label_drop",
                "label_match",
                "label_mismatch"
              ]
            },
            "description": "The transform function to execute"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/MetricsQLFunctionRangeRequest"
              },
              "examples": {
                "round_range_example": {
                  "summary": "Round values over time range",
                  "value": {
                    "query": "round(http_requests_total)",
                    "start": "2025-01-01T00:00:00Z",
                    "end": "2025-01-01T01:00:00Z",
                    "step": "5m"
                  }
                },
                "clamp_range_example": {
                  "summary": "Clamp values between min and max over time range",
                  "value": {
                    "query": "clamp(http_requests_total, 0, 100)",
                    "start": "2025-01-01T00:00:00Z",
                    "end": "2025-01-01T01:00:00Z",
                    "step": "5m",
                    "params": {
                      "min": 0,
                      "max": 100
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Transform function result",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MetricsQLQueryResponse"
                }
              }
            }
          }
        }
      }
    },
    "/metrics/query/aggregate/{function}": {
      "post": {
        "tags": [
          "metrics"
        ],
        "summary": "Execute MetricsQL aggregate function",
        "description": "Executes a MetricsQL aggregate function specified by the {function} path parameter. Supported functions include sum, avg, count, min, max, stddev, stdvar, quantile, topk, bottomk, count_values, absent, increase, delta, rate, irate, deriv, idelta, ideriv, and more.",
        "parameters": [
          {
            "name": "function",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "enum": [
                "sum",
                "avg",
                "count",
                "min",
                "max",
                "stddev",
                "stdvar",
                "quantile",
                "topk",
                "bottomk",
                "count_values",
                "absent",
                "increase",
                "delta",
                "rate",
                "irate",
                "deriv",
                "idelta",
                "ideriv",
                "group",
                "histogram",
                "and",
                "or",
                "unless"
              ]
            },
            "description": "The aggregate function to execute"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/MetricsQLFunctionRequest"
              },
              "examples": {
                "sum_example": {
                  "summary": "Sum all HTTP requests by job",
                  "value": {
                    "query": "sum(http_requests_total) by (job)"
                  }
                },
                "quantile_example": {
                  "summary": "Calculate 95th percentile of response times",
                  "value": {
                    "query": "quantile(0.95, http_request_duration_seconds)",
                    "params": {
                      "quantile": 0.95
                    }
                  }
                },
                "topk_example": {
                  "summary": "Get top 5 HTTP request rates",
                  "value": {
                    "query": "topk(5, rate(http_requests_total[5m]))",
                    "params": {
                      "k": 5
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Aggregate function result",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MetricsQLQueryResponse"
                }
              }
            }
          }
        }
      }
    },
    "/metrics/query/aggregate/{function}/range": {
      "post": {
        "tags": [
          "metrics"
        ],
        "summary": "Execute MetricsQL aggregate function (range)",
        "description": "Executes a MetricsQL aggregate function over a time range specified by the {function} path parameter. Supported functions include sum, avg, count, min, max, stddev, stdvar, quantile, topk, bottomk, count_values, absent, increase, delta, rate, irate, deriv, idelta, ideriv, group, histogram, and, or, unless]",
        "parameters": [
          {
            "name": "function",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "enum": [
                "sum",
                "avg",
                "count",
                "min",
                "max",
                "stddev",
                "stdvar",
                "quantile",
                "topk",
                "bottomk",
                "count_values",
                "absent",
                "increase",
                "delta",
                "rate",
                "irate",
                "deriv",
                "idelta",
                "ideriv",
                "group",
                "histogram",
                "and",
                "or",
                "unless"
              ]
            },
            "description": "The aggregate function to execute"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/MetricsQLFunctionRangeRequest"
              },
              "examples": {
                "sum_range_example": {
                  "summary": "Sum HTTP requests by job over time range",
                  "value": {
                    "query": "sum(http_requests_total) by (job)",
                    "start": "2025-01-01T00:00:00Z",
                    "end": "2025-01-01T01:00:00Z",
                    "step": "5m"
                  }
                },
                "quantile_range_example": {
                  "summary": "Calculate 95th percentile over time range",
                  "value": {
                    "query": "quantile(0.95, http_request_duration_seconds)",
                    "start": "2025-01-01T00:00:00Z",
                    "end": "2025-01-01T01:00:00Z",
                    "step": "1m",
                    "params": {
                      "quantile": 0.95
                    }
                  }
                },
                "topk_range_example": {
                  "summary": "Get top 5 request rates over time range",
                  "value": {
                    "query": "topk(5, rate(http_requests_total[5m]))",
                    "start": "2025-01-01T00:00:00Z",
                    "end": "2025-01-01T01:00:00Z",
                    "step": "1m",
                    "params": {
                      "k": 5
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Aggregate function result",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MetricsQLQueryResponse"
                }
              }
            }
          }
        }
      }
    },
    "/metrics/query/label/{function}": {
      "post": {
        "tags": [
          "metrics"
        ],
        "summary": "Execute MetricsQL label function",
        "description": "Executes a MetricsQL label function specified by the {function} path parameter. Supported functions include label_replace, label_join, label_set, label_keep, label_drop, label_match, label_mismatch, and more.",
        "parameters": [
          {
            "name": "function",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "enum": [
                "label_replace",
                "label_join",
                "label_set",
                "label_keep",
                "label_drop",
                "label_match",
                "label_mismatch"
              ]
            },
            "description": "The label function to execute"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/MetricsQLFunctionRequest"
              },
              "examples": {
                "label_replace_example": {
                  "summary": "Replace label values using regex",
                  "value": {
                    "query": "label_replace(up, \"job\", \"$1\", \"instance\", \"(.*):.*\")",
                    "params": {
                      "dst": "job",
                      "replacement": "$1",
                      "src": "instance",
                      "regex": "(.*):.*"
                    }
                  }
                },
                "label_keep_example": {
                  "summary": "Keep only specific labels",
                  "value": {
                    "query": "label_keep(http_requests_total, \"job\", \"instance\")",
                    "params": {
                      "labels": [
                        "job",
                        "instance"
                      ]
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Label function result",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MetricsQLQueryResponse"
                }
              }
            }
          }
        }
      }
    },
    "/metrics/query/label/{function}/range": {
      "post": {
        "tags": [
          "metrics"
        ],
        "summary": "Execute MetricsQL label function (range)",
        "description": "Executes a MetricsQL label function over a time range specified by the {function} path parameter. Supported functions include label_replace, label_join, label_set, label_keep, label_drop, label_match, label_mismatch, and more.",
        "parameters": [
          {
            "name": "function",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "enum": [
                "label_replace",
                "label_join",
                "label_set",
                "label_keep",
                "label_drop",
                "label_match",
                "label_mismatch"
              ]
            },
            "description": "The label function to execute"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/MetricsQLFunctionRangeRequest"
              },
              "examples": {
                "label_replace_range_example": {
                  "summary": "Replace label values over time range",
                  "value": {
                    "query": "label_replace(up, \"job\", \"$1\", \"instance\", \"(.*):.*\")",
                    "start": "2025-01-01T00:00:00Z",
                    "end": "2025-01-01T01:00:00Z",
                    "step": "5m",
                    "params": {
                      "dst": "job",
                      "replacement": "$1",
                      "src": "instance",
                      "regex": "(.*):.*"
                    }
                  }
                },
                "label_keep_range_example": {
                  "summary": "Keep specific labels over time range",
                  "value": {
                    "query": "label_keep(http_requests_total, \"job\", \"instance\")",
                    "start": "2025-01-01T00:00:00Z",
                    "end": "2025-01-01T01:00:00Z",
                    "step": "5m",
                    "params": {
                      "labels": [
                        "job",
                        "instance"
                      ]
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Label function result",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MetricsQLQueryResponse"
                }
              }
            }
          }
        }
      }
    },
    "/logs/query": {
      "post": {
        "tags": [
          "logs"
        ],
        "summary": "LogsQL query (VictoriaLogs)",
        "description": "Accepts Lucene or Bleve expressions via `query` when `query_language` is `lucene` (or when auto-detected).\nSpecify `search_engine` as `bleve` to use Bleve search capabilities alongside existing Lucene functionality.\nMirador translates queries to VictoriaLogs query syntax.\nNote: Use either `_time` inside `query` or top-level `start`/`end`, not both. If both are provided, the\nserver prioritizes `_time` in `query` to avoid conflicting time filters.\nWhen multiple logs sources are configured in config.yaml (database.victoria_logs + database.logs_sources),\nthe server fans out the query and concatenates rows from all sources; the `fields` list is the union.\n",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string",
                    "description": "LogsQL expression (e.g., `{service.name=\"telemetrygen\"} AND severity=\"Info\" AND _msg~\"message\"`)"
                  },
                  "query_language": {
                    "type": "string",
                    "enum": [
                      "lucene",
                      "logsql"
                    ],
                    "description": "If `lucene`, the server translates to VictoriaLogs query."
                  },
                  "search_engine": {
                    "type": "string",
                    "enum": [
                      "lucene",
                      "bleve"
                    ],
                    "description": "Search engine to use for query processing (default is lucene for backward compatibility)"
                  },
                  "start": {
                    "type": "integer",
                    "format": "int64",
                    "description": "Start time in milliseconds since epoch"
                  },
                  "end": {
                    "type": "integer",
                    "format": "int64",
                    "description": "End time in milliseconds since epoch"
                  },
                  "limit": {
                    "type": "integer",
                    "description": "Max rows to return (default 1000)"
                  },
                  "tenantId": {
                    "type": "string",
                    "description": "Optional tenant override"
                  }
                }
              },
              "examples": {
                "lucene_query": {
                  "summary": "Query logs using Lucene syntax with Lucene search engine",
                  "value": {
                    "query_language": "lucene",
                    "search_engine": "lucene",
                    "query": "_time:[now-15m, now] AND service.name:telemetrygen AND severity:Info",
                    "limit": 200
                  }
                },
                "bleve_query": {
                  "summary": "Query logs using Lucene syntax with Bleve search engine",
                  "value": {
                    "query_language": "lucene",
                    "search_engine": "bleve",
                    "query": "_time:[now-15m, now] AND service.name:telemetrygen AND severity:Info",
                    "limit": 200
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/logs/streams": {
      "get": {
        "tags": [
          "logs"
        ],
        "summary": "Log streams",
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/logs/fields": {
      "get": {
        "tags": [
          "logs"
        ],
        "summary": "Log fields",
        "description": "Returns only the union of field names derived from a hardcoded query over the last 10 minutes. Response contains only the fields array.",
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "fields": {
                          "type": "array",
                          "items": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/logs/export": {
      "post": {
        "tags": [
          "logs"
        ],
        "summary": "Export logs (streaming)",
        "description": "Streams a file attachment. Defaults to CSV when format is omitted. May convert JSON/NDJSON to CSV on the fly.\nAccepts Lucene via `query_language=lucene` and translates to VictoriaLogs query.\nNote: Use either `_time` inside `query` or top-level `start`/`end`, not both. If both are provided, the\nserver prioritizes `_time` in `query`.\n",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string"
                  },
                  "query_language": {
                    "type": "string",
                    "enum": [
                      "lucene",
                      "logsql"
                    ]
                  },
                  "start": {
                    "type": "integer",
                    "format": "int64"
                  },
                  "end": {
                    "type": "integer",
                    "format": "int64"
                  },
                  "limit": {
                    "type": "integer"
                  },
                  "format": {
                    "type": "string",
                    "enum": [
                      "csv",
                      "json"
                    ]
                  }
                }
              },
              "example": {
                "query_language": "lucene",
                "query": "_time:[now-5m, now] AND level:error",
                "format": "csv"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "File stream",
            "content": {
              "text/csv": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              },
              "application/json": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              }
            }
          }
        }
      }
    },
    "/logs/store": {
      "post": {
        "tags": [
          "logs"
        ],
        "summary": "Store JSON event to logs",
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/logs/histogram": {
      "get": {
        "tags": [
          "logs"
        ],
        "summary": "Histogram (D3)",
        "description": "Supports Lucene via `query_language=lucene` (server translates to VictoriaLogs query). Response shape unchanged\nfor D3. Note: Use either `_time` in `query` or top-level `start`/`end`, not both. If both are present, `_time`\nin `query` takes precedence.\n",
        "parameters": [
          {
            "in": "query",
            "name": "query_language",
            "schema": {
              "type": "string",
              "enum": [
                "lucene",
                "logsql"
              ]
            },
            "description": "If `lucene`, the server translates to VictoriaLogs query."
          },
          {
            "in": "query",
            "name": "query",
            "schema": {
              "type": "string"
            },
            "description": "Lucene expression for filtering logs",
            "example": "_time:[now-30m, now]"
          },
          {
            "in": "query",
            "name": "step",
            "schema": {
              "type": "integer",
              "format": "int64"
            },
            "description": "Bucket width in ms",
            "example": 60000
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "example": {
                  "buckets": [
                    {
                      "ts": 1737000000000,
                      "count": 42
                    },
                    {
                      "ts": 1737000060000,
                      "count": 30
                    }
                  ],
                  "stats": {
                    "buckets": 2,
                    "sampleN": 1
                  },
                  "sampled": false
                }
              }
            }
          }
        }
      }
    },
    "/logs/facets": {
      "get": {
        "tags": [
          "logs"
        ],
        "summary": "Facets (D3)",
        "description": "Supports Lucene via `query_language=lucene` (server translates to VictoriaLogs query). Response shape unchanged\nfor D3. Note: Use either `_time` in `query` or top-level `start`/`end`, not both. If both are present, `_time`\nin `query` takes precedence.\n",
        "parameters": [
          {
            "in": "query",
            "name": "query_language",
            "schema": {
              "type": "string",
              "enum": [
                "lucene",
                "logsql"
              ]
            },
            "description": "If `lucene`, the server translates to VictoriaLogs query."
          },
          {
            "in": "query",
            "name": "query",
            "schema": {
              "type": "string"
            },
            "description": "Lucene expression for filtering logs before faceting",
            "example": "_time:[now-30m, now] AND level:error"
          },
          {
            "in": "query",
            "name": "fields",
            "schema": {
              "type": "string"
            },
            "description": "Comma-separated fields to facet on",
            "example": "service,host"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "example": {
                  "facets": [
                    {
                      "field": "service",
                      "buckets": [
                        {
                          "key": "checkout",
                          "count": 120
                        },
                        {
                          "key": "api",
                          "count": 75
                        }
                      ]
                    }
                  ],
                  "stats": {
                    "fields": 1,
                    "sampleN": 1
                  },
                  "sampled": false
                }
              }
            }
          }
        }
      }
    },
    "/logs/search": {
      "post": {
        "tags": [
          "logs"
        ],
        "summary": "Search logs (D3)",
        "description": "Supports Lucene via `query_language=lucene`; translated to VictoriaLogs query. Note: Use either `_time` in\n`query` or top-level `start`/`end`, not both. If both are present, `_time` in `query` takes precedence.\n",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string",
                    "description": "LogsQL expression (e.g., \"_time:5m service=web\")"
                  },
                  "query_language": {
                    "type": "string",
                    "enum": [
                      "lucene",
                      "logsql"
                    ]
                  },
                  "search_engine": {
                    "type": "string",
                    "enum": [
                      "lucene",
                      "bleve"
                    ],
                    "description": "Search engine to use for query processing (default is lucene for backward compatibility)"
                  },
                  "start": {
                    "type": "integer",
                    "format": "int64",
                    "description": "Start time in ms since epoch"
                  },
                  "end": {
                    "type": "integer",
                    "format": "int64",
                    "description": "End time in ms since epoch"
                  },
                  "limit": {
                    "type": "integer",
                    "description": "Rows per page (default 1000, max 10000)"
                  },
                  "page_after": {
                    "type": "object",
                    "properties": {
                      "ts": {
                        "type": "integer",
                        "format": "int64",
                        "description": "Cursor timestamp (ms)"
                      },
                      "offset": {
                        "type": "integer",
                        "description": "Offset for same-ms rows"
                      }
                    }
                  },
                  "tenantId": {
                    "type": "string",
                    "description": "Optional tenant override"
                  }
                }
              },
              "examples": {
                "lucene_search": {
                  "summary": "Search logs using Lucene query syntax",
                  "value": {
                    "query_language": "lucene",
                    "query": "_time:15m AND level:error AND service:checkout",
                    "search_engine": "lucene",
                    "limit": 200
                  }
                },
                "bleve_search": {
                  "summary": "Search logs using Bleve query syntax",
                  "value": {
                    "query_language": "lucene",
                    "query": "_time:15m AND level:error AND service:checkout",
                    "search_engine": "bleve",
                    "limit": 200
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/logs/tail": {
      "get": {
        "tags": [
          "logs"
        ],
        "summary": "Tail logs (WebSocket)",
        "description": "Upgrades to a WebSocket connection and streams log rows as JSON frames.\nNote: Swagger \"Try it out\" sends a normal HTTP request and will not work here.\nUse a WebSocket client, for example:\n\nAuthentication is required during the upgrade: include either an `Authorization: Bearer <token>` header or an `X-Session-Token` header. Tokens in the query string are ignored.\n\n- wscat: `wscat -H \"Authorization: Bearer <token>\" -c ws://127.0.0.1:8010/api/v1/logs/tail?query=_time:5m&sampling=10`\n- websocat: `websocat -H \"Authorization: Bearer <token>\" -n ws://127.0.0.1:8010/api/v1/logs/tail?query=_time:5m`\n- Browser console (requires an existing authenticated session cookie): `new WebSocket(\"ws://127.0.0.1:8010/api/v1/logs/tail?query=_time:5m\")`\n\nQuery parameters:\n- `query`: LogsQL expression (e.g., `_time:5m`)\n- `since`: Start time in milliseconds since epoch (defaults to last 5 minutes)\n- `sampling`: Send every Nth row (integer, default 1)\n- `tenantId`: Optional tenant override\n",
        "parameters": [
          {
            "in": "query",
            "name": "query",
            "schema": {
              "type": "string"
            },
            "description": "LogsQL expression (e.g., `_time:5m`)"
          },
          {
            "in": "query",
            "name": "query_language",
            "schema": {
              "type": "string",
              "enum": [
                "lucene",
                "logsql"
              ]
            },
            "description": "If `lucene`, the server translates to VictoriaLogs query."
          },
          {
            "in": "query",
            "name": "since",
            "schema": {
              "type": "integer",
              "format": "int64"
            },
            "description": "Start timestamp in ms (defaults to now-5m)"
          },
          {
            "in": "query",
            "name": "sampling",
            "schema": {
              "type": "integer",
              "minimum": 1
            },
            "description": "Downsample by sending every Nth row (default 1)"
          },
          {
            "in": "query",
            "name": "tenantId",
            "schema": {
              "type": "string"
            },
            "description": "Optional tenant override for the request"
          }
        ],
        "responses": {
          "101": {
            "description": "Switching Protocols (WebSocket upgrade successful)"
          },
          "426": {
            "description": "Upgrade Required  endpoint must be called via WebSocket (not HTTP)"
          }
        }
      }
    },
    "/traces/services": {
      "get": {
        "tags": [
          "traces"
        ],
        "summary": "List services (VictoriaTraces/Jaeger)",
        "description": "Returns the union of services when multiple traces sources are configured (database.victoria_traces + database.traces_sources).",
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/traces/services/{service}/operations": {
      "get": {
        "tags": [
          "traces"
        ],
        "summary": "List operations for a service",
        "parameters": [
          {
            "in": "path",
            "name": "service",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/traces/{traceId}": {
      "get": {
        "tags": [
          "traces"
        ],
        "summary": "Get trace by ID",
        "description": "Returns the first matching trace across configured sources when multiple traces sources are present.",
        "parameters": [
          {
            "in": "path",
            "name": "traceId",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          },
          "404": {
            "description": "Not Found"
          }
        }
      }
    },
    "/traces/{traceId}/flamegraph": {
      "get": {
        "tags": [
          "traces"
        ],
        "summary": "Flame graph tree for a trace (D3)",
        "description": "Returns a hierarchical structure suitable for d3-flame-graph built from the Jaeger trace spans using CHILD_OF references.",
        "parameters": [
          {
            "in": "path",
            "name": "traceId",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "mode",
            "schema": {
              "type": "string",
              "enum": [
                "duration",
                "self"
              ]
            },
            "description": "Node sizing mode. duration = total span duration; self = duration minus children durations (approximate)."
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "name": {
                          "type": "string"
                        },
                        "value": {
                          "type": "integer"
                        },
                        "children": {
                          "type": "array",
                          "items": {
                            "$ref": "#/components/schemas/FlameNode"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/traces/flamegraph/search": {
      "post": {
        "tags": [
          "traces"
        ],
        "summary": "Aggregate flame graph over a traces search (D3)",
        "description": "Searches VictoriaTraces (Jaeger) and merges returned traces into a single flame graph tree. Useful for service-level flame graphs over a time window.",
        "parameters": [
          {
            "in": "query",
            "name": "mode",
            "schema": {
              "type": "string",
              "enum": [
                "duration",
                "self"
              ]
            },
            "description": "Node sizing mode. duration = total span duration; self = duration minus children durations (approximate)."
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string"
                    },
                    "data": {
                      "$ref": "#/components/schemas/FlameNode"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/traces/search": {
      "post": {
        "tags": [
          "traces"
        ],
        "summary": "Search traces",
        "description": "Jaeger-compatible search across traces. This endpoint accepts Lucene or Bleve expressions via\n`query_language=lucene` and `query`, which Mirador translates into Jaeger filters (service,\noperation, tags, durations, and time window). Specify `search_engine` as `bleve` to use Bleve search capabilities.\nNote: Use either `_time` in `query` or top-level `start`/`end`,\nnot both. If both are provided, `_time` in `query` takes precedence. Alternatively, discover trace IDs via\n`/logs/search` with a Lucene filter on `trace_id`, then fetch traces by ID using `/traces/{traceId}`.\nWhen multiple traces sources are configured in config.yaml (database.victoria_traces + database.traces_sources),\nresults from all sources are concatenated.\n",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "query": {
                    "type": "string",
                    "description": "Optional Lucene expression (e.g., \"_time:[now-15m TO now] AND service:checkout AND operation:CreateOrder AND duration:[10ms TO *]\")"
                  },
                  "query_language": {
                    "type": "string",
                    "enum": [
                      "lucene"
                    ],
                    "description": "Set to `lucene` to enable translation"
                  },
                  "search_engine": {
                    "type": "string",
                    "enum": [
                      "lucene",
                      "bleve"
                    ],
                    "description": "Search engine to use for query processing (default is lucene for backward compatibility)"
                  },
                  "service": {
                    "type": "string"
                  },
                  "operation": {
                    "type": "string"
                  },
                  "tags": {
                    "type": "string",
                    "description": "Comma-separated key=value pairs"
                  },
                  "minDuration": {
                    "type": "string"
                  },
                  "maxDuration": {
                    "type": "string"
                  },
                  "start": {
                    "type": "string",
                    "format": "date-time"
                  },
                  "end": {
                    "type": "string",
                    "format": "date-time"
                  },
                  "limit": {
                    "type": "integer"
                  }
                }
              },
              "examples": {
                "lucene_search": {
                  "summary": "Search traces using Lucene query syntax",
                  "value": {
                    "query": "_time:[now-15m TO now] AND service:checkout AND operation:CreateOrder",
                    "query_language": "lucene",
                    "search_engine": "lucene",
                    "limit": 100
                  }
                },
                "bleve_search": {
                  "summary": "Search traces using Bleve query syntax",
                  "value": {
                    "query": "_time:[now-15m TO now] AND service:checkout AND operation:CreateOrder",
                    "query_language": "lucene",
                    "search_engine": "bleve",
                    "limit": 100
                  }
                },
                "lucene_with_tags": {
                  "summary": "Search traces with specific tags using Lucene",
                  "value": {
                    "query": "service:otelgen AND span.kind:client",
                    "query_language": "lucene",
                    "search_engine": "lucene",
                    "start": "2025-10-04T00:00:00.000Z",
                    "end": "2025-10-04T23:59:59.999Z",
                    "limit": 100
                  }
                },
                "bleve_with_tags": {
                  "summary": "Search traces with specific tags using Bleve",
                  "value": {
                    "query": "service:otelgen AND span.kind:client",
                    "query_language": "lucene",
                    "search_engine": "bleve",
                    "start": "2025-10-04T00:00:00.000Z",
                    "end": "2025-10-04T23:59:59.999Z",
                    "limit": 100
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/config/datasources": {
      "get": {
        "tags": [
          "config"
        ],
        "summary": "Get data sources",
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      },
      "post": {
        "tags": [
          "config"
        ],
        "summary": "Add data source",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/config/integrations": {
      "get": {
        "tags": [
          "config"
        ],
        "summary": "Get integrations config",
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/config/features": {
      "get": {
        "tags": [
          "config"
        ],
        "summary": "Get runtime feature flags",
        "description": "Retrieve the current state of runtime feature flags for the tenant",
        "responses": {
          "200": {
            "description": "Feature flags retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "success"
                      ]
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "tenantId": {
                          "type": "string",
                          "description": "The tenant identifier"
                        },
                        "features": {
                          "type": "object",
                          "properties": {
                            "rca_enabled": {
                              "type": "boolean",
                              "description": "Whether RCA (Root Cause Analysis) features are enabled"
                            },
                            "user_settings_enabled": {
                              "type": "boolean",
                              "description": "Whether user settings features are enabled"
                            },
                            "rbac_enabled": {
                              "type": "boolean",
                              "description": "Whether RBAC (Role-Based Access Control) features are enabled"
                            }
                          }
                        }
                      },
                      "required": [
                        "tenantId",
                        "features"
                      ]
                    },
                    "timestamp": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Timestamp of the response"
                    }
                  },
                  "required": [
                    "status",
                    "data",
                    "timestamp"
                  ]
                },
                "example": {
                  "status": "success",
                  "data": {
                    "tenantId": "default",
                    "features": {
                      "rca_enabled": true,
                      "user_settings_enabled": true,
                      "rbac_enabled": true
                    }
                  },
                  "timestamp": "2025-10-19T13:46:07Z"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "config"
        ],
        "summary": "Update runtime feature flags",
        "description": "Update one or more runtime feature flags without restarting the service",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "features": {
                    "type": "object",
                    "properties": {
                      "rca_enabled": {
                        "type": "boolean",
                        "description": "Enable/disable RCA features"
                      },
                      "user_settings_enabled": {
                        "type": "boolean",
                        "description": "Enable/disable user settings features"
                      },
                      "rbac_enabled": {
                        "type": "boolean",
                        "description": "Enable/disable RBAC features"
                      }
                    },
                    "additionalProperties": false,
                    "description": "Feature flags to update"
                  }
                },
                "required": [
                  "features"
                ]
              },
              "example": {
                "features": {
                  "rca_enabled": false
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Feature flags updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "success"
                      ]
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "tenantId": {
                          "type": "string",
                          "description": "The tenant identifier"
                        },
                        "features": {
                          "type": "object",
                          "properties": {
                            "rca_enabled": {
                              "type": "boolean"
                            },
                            "user_settings_enabled": {
                              "type": "boolean"
                            },
                            "rbac_enabled": {
                              "type": "boolean"
                            }
                          }
                        },
                        "updated": {
                          "type": "boolean",
                          "description": "Indicates if the flags were updated"
                        }
                      },
                      "required": [
                        "tenantId",
                        "features",
                        "updated"
                      ]
                    },
                    "timestamp": {
                      "type": "string",
                      "format": "date-time"
                    }
                  },
                  "required": [
                    "status",
                    "data",
                    "timestamp"
                  ]
                },
                "example": {
                  "status": "success",
                  "data": {
                    "tenantId": "default",
                    "features": {
                      "rca_enabled": false,
                      "user_settings_enabled": true,
                      "rbac_enabled": true
                    },
                    "updated": true
                  },
                  "timestamp": "2025-10-19T13:46:55Z"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request format or unknown feature flag",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "error"
                      ]
                    },
                    "error": {
                      "type": "string",
                      "description": "Error message describing the validation failure"
                    }
                  },
                  "required": [
                    "status",
                    "error"
                  ]
                },
                "example": {
                  "status": "error",
                  "error": "Invalid feature flags format"
                }
              }
            }
          }
        }
      }
    },
    "/config/features/reset": {
      "post": {
        "tags": [
          "config"
        ],
        "summary": "Reset feature flags to defaults",
        "description": "Reset all runtime feature flags to their default enabled state",
        "responses": {
          "200": {
            "description": "Feature flags reset successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "success"
                      ]
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "tenantId": {
                          "type": "string",
                          "description": "The tenant identifier"
                        },
                        "features": {
                          "type": "object",
                          "properties": {
                            "rca_enabled": {
                              "type": "boolean"
                            },
                            "user_settings_enabled": {
                              "type": "boolean"
                            },
                            "rbac_enabled": {
                              "type": "boolean"
                            }
                          }
                        },
                        "reset": {
                          "type": "boolean",
                          "description": "Indicates if the flags were reset"
                        }
                      },
                      "required": [
                        "tenantId",
                        "features",
                        "reset"
                      ]
                    },
                    "timestamp": {
                      "type": "string",
                      "format": "date-time"
                    }
                  },
                  "required": [
                    "status",
                    "data",
                    "timestamp"
                  ]
                },
                "example": {
                  "status": "success",
                  "data": {
                    "tenantId": "default",
                    "features": {
                      "rca_enabled": true,
                      "user_settings_enabled": true,
                      "rbac_enabled": true
                    },
                    "reset": true
                  },
                  "timestamp": "2025-10-19T13:48:37Z"
                }
              }
            }
          },
          "500": {
            "description": "Failed to reset feature flags",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "error"
                      ]
                    },
                    "error": {
                      "type": "string",
                      "description": "Error message describing the failure"
                    }
                  },
                  "required": [
                    "status",
                    "error"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/config/grpc/endpoints": {
      "get": {
        "tags": [
          "config"
        ],
        "summary": "Get gRPC endpoint configurations",
        "description": "Retrieve the current gRPC endpoint configurations for RCA, PREDICT, and ALERTS services",
        "responses": {
          "200": {
            "description": "gRPC endpoints retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "success"
                      ]
                    },
                    "data": {
                      "$ref": "#/components/schemas/GRPCEndpointsConfig"
                    },
                    "timestamp": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Timestamp of the response"
                    }
                  },
                  "required": [
                    "status",
                    "data",
                    "timestamp"
                  ]
                },
                "example": {
                  "status": "success",
                  "data": {
                    "rca_endpoint": "rca-service:50051",
                    "alerts_endpoint": "alerts-service:50053"
                  },
                  "timestamp": "2025-10-19T14:00:00Z"
                }
              }
            }
          },
          "500": {
            "description": "Failed to retrieve gRPC endpoints",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "error"
                      ]
                    },
                    "error": {
                      "type": "string",
                      "description": "Error message describing the failure"
                    }
                  },
                  "required": [
                    "status",
                    "error"
                  ]
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "config"
        ],
        "summary": "Update gRPC endpoint configurations",
        "description": "Update one or more gRPC endpoint configurations without restarting the service. The gRPC clients will dynamically reconnect to the new endpoints.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/GRPCEndpointsUpdateRequest"
              },
              "example": {
                "rca_endpoint": "rca-service-new:50051"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "gRPC endpoints updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "success"
                      ]
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "tenantId": {
                          "type": "string",
                          "description": "The tenant identifier"
                        },
                        "endpoints": {
                          "$ref": "#/components/schemas/GRPCEndpointsConfig"
                        },
                        "updated": {
                          "type": "boolean",
                          "description": "Indicates if the endpoints were updated"
                        }
                      },
                      "required": [
                        "tenantId",
                        "endpoints",
                        "updated"
                      ]
                    },
                    "timestamp": {
                      "type": "string",
                      "format": "date-time"
                    }
                  },
                  "required": [
                    "status",
                    "data",
                    "timestamp"
                  ]
                },
                "example": {
                  "status": "success",
                  "data": {
                    "tenantId": "default",
                    "endpoints": {
                      "rca_endpoint": "rca-service-new:50051",
                      "alerts_endpoint": "alerts-service:50053"
                    },
                    "updated": true
                  },
                  "timestamp": "2025-10-19T14:05:00Z"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request format or unknown endpoint",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "error"
                      ]
                    },
                    "error": {
                      "type": "string",
                      "description": "Error message describing the validation failure"
                    }
                  },
                  "required": [
                    "status",
                    "error"
                  ]
                },
                "example": {
                  "status": "error",
                  "error": "Invalid endpoint format"
                }
              }
            }
          },
          "500": {
            "description": "Failed to update gRPC endpoints",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "error"
                      ]
                    },
                    "error": {
                      "type": "string",
                      "description": "Error message describing the failure"
                    }
                  },
                  "required": [
                    "status",
                    "error"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/config/grpc/endpoints/reset": {
      "post": {
        "tags": [
          "config"
        ],
        "summary": "Reset gRPC endpoint configurations to defaults",
        "description": "Reset all gRPC endpoint configurations to their default values from the static configuration",
        "responses": {
          "200": {
            "description": "gRPC endpoints reset successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "success"
                      ]
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "tenantId": {
                          "type": "string",
                          "description": "The tenant identifier"
                        },
                        "endpoints": {
                          "$ref": "#/components/schemas/GRPCEndpointsConfig"
                        },
                        "reset": {
                          "type": "boolean",
                          "description": "Indicates if the endpoints were reset"
                        }
                      },
                      "required": [
                        "tenantId",
                        "endpoints",
                        "reset"
                      ]
                    },
                    "timestamp": {
                      "type": "string",
                      "format": "date-time"
                    }
                  },
                  "required": [
                    "status",
                    "data",
                    "timestamp"
                  ]
                },
                "example": {
                  "status": "success",
                  "data": {
                    "tenantId": "default",
                    "endpoints": {
                      "rca_endpoint": "rca-service:50051",
                      "alerts_endpoint": "alerts-service:50053"
                    },
                    "reset": true
                  },
                  "timestamp": "2025-10-19T14:10:00Z"
                }
              }
            }
          },
          "500": {
            "description": "Failed to reset gRPC endpoints",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "error"
                      ]
                    },
                    "error": {
                      "type": "string",
                      "description": "Error message describing the failure"
                    }
                  },
                  "required": [
                    "status",
                    "error"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/config/user-preferences": {
      "get": {
        "tags": [
          "config"
        ],
        "summary": "Get user preferences",
        "description": "Retrieve user preferences for the current user or specified user",
        "parameters": [
          {
            "in": "query",
            "name": "userId",
            "schema": {
              "type": "string"
            },
            "description": "Optional user ID to get preferences for (defaults to current user)"
          }
        ],
        "responses": {
          "200": {
            "description": "User preferences retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "success"
                      ]
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "userId": {
                          "type": "string",
                          "description": "The user identifier"
                        },
                        "preferences": {
                          "type": "object",
                          "description": "User preference settings"
                        },
                        "tenantId": {
                          "type": "string",
                          "description": "The tenant identifier"
                        }
                      },
                      "required": [
                        "userId",
                        "preferences",
                        "tenantId"
                      ]
                    },
                    "timestamp": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Timestamp of the response"
                    }
                  },
                  "required": [
                    "status",
                    "data",
                    "timestamp"
                  ]
                },
                "example": {
                  "status": "success",
                  "data": {
                    "userId": "user123",
                    "preferences": {
                      "theme": "dark",
                      "timezone": "UTC",
                      "notifications": true
                    },
                    "tenantId": "default"
                  },
                  "timestamp": "2025-11-08T10:00:00Z"
                }
              }
            }
          },
          "404": {
            "description": "User preferences not found",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "error"
                      ]
                    },
                    "error": {
                      "type": "string",
                      "description": "Error message"
                    }
                  },
                  "required": [
                    "status",
                    "error"
                  ]
                },
                "example": {
                  "status": "error",
                  "error": "User preferences not found"
                }
              }
            }
          },
          "500": {
            "description": "Failed to retrieve user preferences",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "error"
                      ]
                    },
                    "error": {
                      "type": "string",
                      "description": "Error message describing the failure"
                    }
                  },
                  "required": [
                    "status",
                    "error"
                  ]
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "config"
        ],
        "summary": "Create user preferences",
        "description": "Create user preferences for a user",
        "parameters": [
          {
            "in": "query",
            "name": "userId",
            "schema": {
              "type": "string"
            },
            "description": "Optional user ID to create preferences for (defaults to current user)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "preferences": {
                    "type": "object",
                    "description": "User preference settings to create"
                  }
                },
                "required": [
                  "preferences"
                ]
              },
              "example": {
                "preferences": {
                  "theme": "dark",
                  "timezone": "UTC",
                  "notifications": true
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "User preferences created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "success"
                      ]
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "userId": {
                          "type": "string",
                          "description": "The user identifier"
                        },
                        "preferences": {
                          "type": "object",
                          "description": "Created user preference settings"
                        },
                        "tenantId": {
                          "type": "string",
                          "description": "The tenant identifier"
                        },
                        "created": {
                          "type": "boolean",
                          "description": "Indicates if preferences were created"
                        }
                      },
                      "required": [
                        "userId",
                        "preferences",
                        "tenantId",
                        "created"
                      ]
                    },
                    "timestamp": {
                      "type": "string",
                      "format": "date-time"
                    }
                  },
                  "required": [
                    "status",
                    "data",
                    "timestamp"
                  ]
                },
                "example": {
                  "status": "success",
                  "data": {
                    "userId": "user123",
                    "preferences": {
                      "theme": "dark",
                      "timezone": "UTC",
                      "notifications": true
                    },
                    "tenantId": "default",
                    "created": true
                  },
                  "timestamp": "2025-11-08T10:00:00Z"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request format",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "error"
                      ]
                    },
                    "error": {
                      "type": "string",
                      "description": "Error message describing the validation failure"
                    }
                  },
                  "required": [
                    "status",
                    "error"
                  ]
                }
              }
            }
          },
          "409": {
            "description": "User preferences already exist",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "error"
                      ]
                    },
                    "error": {
                      "type": "string",
                      "description": "Error message"
                    }
                  },
                  "required": [
                    "status",
                    "error"
                  ]
                }
              }
            }
          },
          "500": {
            "description": "Failed to create user preferences",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "error"
                      ]
                    },
                    "error": {
                      "type": "string",
                      "description": "Error message describing the failure"
                    }
                  },
                  "required": [
                    "status",
                    "error"
                  ]
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "config"
        ],
        "summary": "Update user preferences",
        "description": "Update user preferences for the current user or specified user",
        "parameters": [
          {
            "in": "query",
            "name": "userId",
            "schema": {
              "type": "string"
            },
            "description": "Optional user ID to update preferences for (defaults to current user)"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "preferences": {
                    "type": "object",
                    "description": "User preference settings to update"
                  }
                },
                "required": [
                  "preferences"
                ]
              },
              "example": {
                "preferences": {
                  "theme": "light",
                  "timezone": "America/New_York",
                  "notifications": false
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "User preferences updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "success"
                      ]
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "userId": {
                          "type": "string",
                          "description": "The user identifier"
                        },
                        "preferences": {
                          "type": "object",
                          "description": "Updated user preference settings"
                        },
                        "tenantId": {
                          "type": "string",
                          "description": "The tenant identifier"
                        },
                        "updated": {
                          "type": "boolean",
                          "description": "Indicates if preferences were updated"
                        }
                      },
                      "required": [
                        "userId",
                        "preferences",
                        "tenantId",
                        "updated"
                      ]
                    },
                    "timestamp": {
                      "type": "string",
                      "format": "date-time"
                    }
                  },
                  "required": [
                    "status",
                    "data",
                    "timestamp"
                  ]
                },
                "example": {
                  "status": "success",
                  "data": {
                    "userId": "user123",
                    "preferences": {
                      "theme": "light",
                      "timezone": "America/New_York",
                      "notifications": false
                    },
                    "tenantId": "default",
                    "updated": true
                  },
                  "timestamp": "2025-11-08T10:00:00Z"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request format",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "error"
                      ]
                    },
                    "error": {
                      "type": "string",
                      "description": "Error message describing the validation failure"
                    }
                  },
                  "required": [
                    "status",
                    "error"
                  ]
                }
              }
            }
          },
          "404": {
            "description": "User preferences not found",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "error"
                      ]
                    },
                    "error": {
                      "type": "string",
                      "description": "Error message"
                    }
                  },
                  "required": [
                    "status",
                    "error"
                  ]
                }
              }
            }
          },
          "500": {
            "description": "Failed to update user preferences",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "error"
                      ]
                    },
                    "error": {
                      "type": "string",
                      "description": "Error message describing the failure"
                    }
                  },
                  "required": [
                    "status",
                    "error"
                  ]
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "config"
        ],
        "summary": "Delete user preferences",
        "description": "Delete user preferences for the current user or specified user",
        "parameters": [
          {
            "in": "query",
            "name": "userId",
            "schema": {
              "type": "string"
            },
            "description": "Optional user ID to delete preferences for (defaults to current user)"
          }
        ],
        "responses": {
          "200": {
            "description": "User preferences deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "success"
                      ]
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "userId": {
                          "type": "string",
                          "description": "The user identifier"
                        },
                        "tenantId": {
                          "type": "string",
                          "description": "The tenant identifier"
                        },
                        "deleted": {
                          "type": "boolean",
                          "description": "Indicates if preferences were deleted"
                        }
                      },
                      "required": [
                        "userId",
                        "tenantId",
                        "deleted"
                      ]
                    },
                    "timestamp": {
                      "type": "string",
                      "format": "date-time"
                    }
                  },
                  "required": [
                    "status",
                    "data",
                    "timestamp"
                  ]
                },
                "example": {
                  "status": "success",
                  "data": {
                    "userId": "user123",
                    "tenantId": "default",
                    "deleted": true
                  },
                  "timestamp": "2025-11-08T10:00:00Z"
                }
              }
            }
          },
          "404": {
            "description": "User preferences not found",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "error"
                      ]
                    },
                    "error": {
                      "type": "string",
                      "description": "Error message"
                    }
                  },
                  "required": [
                    "status",
                    "error"
                  ]
                }
              }
            }
          },
          "500": {
            "description": "Failed to delete user preferences",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "error"
                      ]
                    },
                    "error": {
                      "type": "string",
                      "description": "Error message describing the failure"
                    }
                  },
                  "required": [
                    "status",
                    "error"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/config/dashboards": {
      "get": {
        "tags": [
          "config"
        ],
        "summary": "Get dashboards",
        "description": "Retrieve dashboards for the current user or all dashboards if admin",
        "parameters": [
          {
            "in": "query",
            "name": "userId",
            "schema": {
              "type": "string"
            },
            "description": "Optional user ID to get dashboards for (defaults to current user)"
          },
          {
            "in": "query",
            "name": "shared",
            "schema": {
              "type": "boolean"
            },
            "description": "Include shared dashboards (default false)"
          },
          {
            "in": "query",
            "name": "limit",
            "schema": {
              "type": "integer",
              "minimum": 1,
              "maximum": 100
            },
            "description": "Maximum number of dashboards to return (default 50)"
          },
          {
            "in": "query",
            "name": "offset",
            "schema": {
              "type": "integer",
              "minimum": 0
            },
            "description": "Number of dashboards to skip (default 0)"
          }
        ],
        "responses": {
          "200": {
            "description": "Dashboards retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "success"
                      ]
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "dashboards": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string",
                                "description": "Dashboard unique identifier"
                              },
                              "name": {
                                "type": "string",
                                "description": "Dashboard name"
                              },
                              "description": {
                                "type": "string",
                                "description": "Dashboard description"
                              },
                              "userId": {
                                "type": "string",
                                "description": "Owner user ID"
                              },
                              "shared": {
                                "type": "boolean",
                                "description": "Whether dashboard is shared"
                              },
                              "layout": {
                                "type": "object",
                                "description": "Dashboard layout configuration"
                              },
                              "createdAt": {
                                "type": "string",
                                "format": "date-time",
                                "description": "Creation timestamp"
                              },
                              "updatedAt": {
                                "type": "string",
                                "format": "date-time",
                                "description": "Last update timestamp"
                              }
                            }
                          }
                        },
                        "total": {
                          "type": "integer",
                          "description": "Total number of dashboards"
                        },
                        "limit": {
                          "type": "integer",
                          "description": "Requested limit"
                        },
                        "offset": {
                          "type": "integer",
                          "description": "Requested offset"
                        },
                        "tenantId": {
                          "type": "string",
                          "description": "The tenant identifier"
                        }
                      },
                      "required": [
                        "dashboards",
                        "total",
                        "tenantId"
                      ]
                    },
                    "timestamp": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Timestamp of the response"
                    }
                  },
                  "required": [
                    "status",
                    "data",
                    "timestamp"
                  ]
                },
                "example": {
                  "status": "success",
                  "data": {
                    "dashboards": [
                      {
                        "id": "dash-123",
                        "name": "API Performance Dashboard",
                        "description": "Monitor API performance metrics",
                        "userId": "user123",
                        "shared": false,
                        "layout": {},
                        "createdAt": "2025-11-01T10:00:00Z",
                        "updatedAt": "2025-11-08T09:00:00Z"
                      }
                    ],
                    "total": 1,
                    "limit": 50,
                    "offset": 0,
                    "tenantId": "default"
                  },
                  "timestamp": "2025-11-08T10:00:00Z"
                }
              }
            }
          },
          "500": {
            "description": "Failed to retrieve dashboards",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "error"
                      ]
                    },
                    "error": {
                      "type": "string",
                      "description": "Error message describing the failure"
                    }
                  },
                  "required": [
                    "status",
                    "error"
                  ]
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "config"
        ],
        "summary": "Create dashboard",
        "description": "Create a new dashboard for the current user",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Dashboard name"
                  },
                  "description": {
                    "type": "string",
                    "description": "Dashboard description"
                  },
                  "shared": {
                    "type": "boolean",
                    "description": "Whether dashboard should be shared (default false)"
                  },
                  "layout": {
                    "type": "object",
                    "description": "Dashboard layout configuration"
                  }
                },
                "required": [
                  "name"
                ]
              },
              "example": {
                "name": "New API Dashboard",
                "description": "Dashboard for monitoring API endpoints",
                "shared": false,
                "layout": {
                  "panels": []
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Dashboard created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "success"
                      ]
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "dashboard": {
                          "type": "object",
                          "properties": {
                            "id": {
                              "type": "string",
                              "description": "Dashboard unique identifier"
                            },
                            "name": {
                              "type": "string",
                              "description": "Dashboard name"
                            },
                            "description": {
                              "type": "string",
                              "description": "Dashboard description"
                            },
                            "userId": {
                              "type": "string",
                              "description": "Owner user ID"
                            },
                            "shared": {
                              "type": "boolean",
                              "description": "Whether dashboard is shared"
                            },
                            "layout": {
                              "type": "object",
                              "description": "Dashboard layout configuration"
                            },
                            "createdAt": {
                              "type": "string",
                              "format": "date-time",
                              "description": "Creation timestamp"
                            },
                            "updatedAt": {
                              "type": "string",
                              "format": "date-time",
                              "description": "Last update timestamp"
                            }
                          }
                        },
                        "tenantId": {
                          "type": "string",
                          "description": "The tenant identifier"
                        },
                        "created": {
                          "type": "boolean",
                          "description": "Indicates if dashboard was created"
                        }
                      },
                      "required": [
                        "dashboard",
                        "tenantId",
                        "created"
                      ]
                    },
                    "timestamp": {
                      "type": "string",
                      "format": "date-time"
                    }
                  },
                  "required": [
                    "status",
                    "data",
                    "timestamp"
                  ]
                },
                "example": {
                  "status": "success",
                  "data": {
                    "dashboard": {
                      "id": "dash-456",
                      "name": "New API Dashboard",
                      "description": "Dashboard for monitoring API endpoints",
                      "userId": "user123",
                      "shared": false,
                      "layout": {
                        "panels": []
                      },
                      "createdAt": "2025-11-08T10:00:00Z",
                      "updatedAt": "2025-11-08T10:00:00Z"
                    },
                    "tenantId": "default",
                    "created": true
                  },
                  "timestamp": "2025-11-08T10:00:00Z"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request format",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "error"
                      ]
                    },
                    "error": {
                      "type": "string",
                      "description": "Error message describing the validation failure"
                    }
                  },
                  "required": [
                    "status",
                    "error"
                  ]
                }
              }
            }
          },
          "500": {
            "description": "Failed to create dashboard",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "error"
                      ]
                    },
                    "error": {
                      "type": "string",
                      "description": "Error message describing the failure"
                    }
                  },
                  "required": [
                    "status",
                    "error"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/config/dashboards/{dashboardId}": {
      "get": {
        "tags": [
          "config"
        ],
        "summary": "Get dashboard by ID",
        "description": "Retrieve a specific dashboard by its ID",
        "parameters": [
          {
            "in": "path",
            "name": "dashboardId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Dashboard unique identifier"
          }
        ],
        "responses": {
          "200": {
            "description": "Dashboard retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "success"
                      ]
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "dashboard": {
                          "type": "object",
                          "properties": {
                            "id": {
                              "type": "string",
                              "description": "Dashboard unique identifier"
                            },
                            "name": {
                              "type": "string",
                              "description": "Dashboard name"
                            },
                            "description": {
                              "type": "string",
                              "description": "Dashboard description"
                            },
                            "userId": {
                              "type": "string",
                              "description": "Owner user ID"
                            },
                            "shared": {
                              "type": "boolean",
                              "description": "Whether dashboard is shared"
                            },
                            "layout": {
                              "type": "object",
                              "description": "Dashboard layout configuration"
                            },
                            "createdAt": {
                              "type": "string",
                              "format": "date-time",
                              "description": "Creation timestamp"
                            },
                            "updatedAt": {
                              "type": "string",
                              "format": "date-time",
                              "description": "Last update timestamp"
                            }
                          }
                        },
                        "tenantId": {
                          "type": "string",
                          "description": "The tenant identifier"
                        }
                      },
                      "required": [
                        "dashboard",
                        "tenantId"
                      ]
                    },
                    "timestamp": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Timestamp of the response"
                    }
                  },
                  "required": [
                    "status",
                    "data",
                    "timestamp"
                  ]
                },
                "example": {
                  "status": "success",
                  "data": {
                    "dashboard": {
                      "id": "dash-123",
                      "name": "API Performance Dashboard",
                      "description": "Monitor API performance metrics",
                      "userId": "user123",
                      "shared": false,
                      "layout": {},
                      "createdAt": "2025-11-01T10:00:00Z",
                      "updatedAt": "2025-11-08T09:00:00Z"
                    },
                    "tenantId": "default"
                  },
                  "timestamp": "2025-11-08T10:00:00Z"
                }
              }
            }
          },
          "403": {
            "description": "Access denied to dashboard",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "error"
                      ]
                    },
                    "error": {
                      "type": "string",
                      "description": "Error message"
                    }
                  },
                  "required": [
                    "status",
                    "error"
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Dashboard not found",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "error"
                      ]
                    },
                    "error": {
                      "type": "string",
                      "description": "Error message"
                    }
                  },
                  "required": [
                    "status",
                    "error"
                  ]
                }
              }
            }
          },
          "500": {
            "description": "Failed to retrieve dashboard",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "error"
                      ]
                    },
                    "error": {
                      "type": "string",
                      "description": "Error message describing the failure"
                    }
                  },
                  "required": [
                    "status",
                    "error"
                  ]
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "config"
        ],
        "summary": "Update dashboard",
        "description": "Update an existing dashboard",
        "parameters": [
          {
            "in": "path",
            "name": "dashboardId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Dashboard unique identifier"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Dashboard name"
                  },
                  "description": {
                    "type": "string",
                    "description": "Dashboard description"
                  },
                  "shared": {
                    "type": "boolean",
                    "description": "Whether dashboard should be shared"
                  },
                  "layout": {
                    "type": "object",
                    "description": "Dashboard layout configuration"
                  }
                }
              },
              "example": {
                "name": "Updated API Dashboard",
                "description": "Updated dashboard for monitoring API endpoints",
                "shared": true,
                "layout": {
                  "panels": []
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Dashboard updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "success"
                      ]
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "dashboard": {
                          "type": "object",
                          "properties": {
                            "id": {
                              "type": "string",
                              "description": "Dashboard unique identifier"
                            },
                            "name": {
                              "type": "string",
                              "description": "Dashboard name"
                            },
                            "description": {
                              "type": "string",
                              "description": "Dashboard description"
                            },
                            "userId": {
                              "type": "string",
                              "description": "Owner user ID"
                            },
                            "shared": {
                              "type": "boolean",
                              "description": "Whether dashboard is shared"
                            },
                            "layout": {
                              "type": "object",
                              "description": "Dashboard layout configuration"
                            },
                            "createdAt": {
                              "type": "string",
                              "format": "date-time",
                              "description": "Creation timestamp"
                            },
                            "updatedAt": {
                              "type": "string",
                              "format": "date-time",
                              "description": "Last update timestamp"
                            }
                          }
                        },
                        "tenantId": {
                          "type": "string",
                          "description": "The tenant identifier"
                        },
                        "updated": {
                          "type": "boolean",
                          "description": "Indicates if dashboard was updated"
                        }
                      },
                      "required": [
                        "dashboard",
                        "tenantId",
                        "updated"
                      ]
                    },
                    "timestamp": {
                      "type": "string",
                      "format": "date-time"
                    }
                  },
                  "required": [
                    "status",
                    "data",
                    "timestamp"
                  ]
                },
                "example": {
                  "status": "success",
                  "data": {
                    "dashboard": {
                      "id": "dash-123",
                      "name": "Updated API Dashboard",
                      "description": "Updated dashboard for monitoring API endpoints",
                      "userId": "user123",
                      "shared": true,
                      "layout": {
                        "panels": []
                      },
                      "createdAt": "2025-11-01T10:00:00Z",
                      "updatedAt": "2025-11-08T10:00:00Z"
                    },
                    "tenantId": "default",
                    "updated": true
                  },
                  "timestamp": "2025-11-08T10:00:00Z"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request format",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "error"
                      ]
                    },
                    "error": {
                      "type": "string",
                      "description": "Error message describing the validation failure"
                    }
                  },
                  "required": [
                    "status",
                    "error"
                  ]
                }
              }
            }
          },
          "403": {
            "description": "Access denied to dashboard",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "error"
                      ]
                    },
                    "error": {
                      "type": "string",
                      "description": "Error message"
                    }
                  },
                  "required": [
                    "status",
                    "error"
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Dashboard not found",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "error"
                      ]
                    },
                    "error": {
                      "type": "string",
                      "description": "Error message"
                    }
                  },
                  "required": [
                    "status",
                    "error"
                  ]
                }
              }
            }
          },
          "500": {
            "description": "Failed to update dashboard",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "error"
                      ]
                    },
                    "error": {
                      "type": "string",
                      "description": "Error message describing the failure"
                    }
                  },
                  "required": [
                    "status",
                    "error"
                  ]
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "config"
        ],
        "summary": "Delete dashboard",
        "description": "Delete a dashboard by its ID",
        "parameters": [
          {
            "in": "path",
            "name": "dashboardId",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Dashboard unique identifier"
          }
        ],
        "responses": {
          "200": {
            "description": "Dashboard deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "success"
                      ]
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "dashboardId": {
                          "type": "string",
                          "description": "Deleted dashboard ID"
                        },
                        "tenantId": {
                          "type": "string",
                          "description": "The tenant identifier"
                        },
                        "deleted": {
                          "type": "boolean",
                          "description": "Indicates if dashboard was deleted"
                        }
                      },
                      "required": [
                        "dashboardId",
                        "tenantId",
                        "deleted"
                      ]
                    },
                    "timestamp": {
                      "type": "string",
                      "format": "date-time"
                    }
                  },
                  "required": [
                    "status",
                    "data",
                    "timestamp"
                  ]
                },
                "example": {
                  "status": "success",
                  "data": {
                    "dashboardId": "dash-123",
                    "tenantId": "default",
                    "deleted": true
                  },
                  "timestamp": "2025-11-08T10:00:00Z"
                }
              }
            }
          },
          "403": {
            "description": "Access denied to dashboard",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "error"
                      ]
                    },
                    "error": {
                      "type": "string",
                      "description": "Error message"
                    }
                  },
                  "required": [
                    "status",
                    "error"
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Dashboard not found",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "error"
                      ]
                    },
                    "error": {
                      "type": "string",
                      "description": "Error message"
                    }
                  },
                  "required": [
                    "status",
                    "error"
                  ]
                }
              }
            }
          },
          "500": {
            "description": "Failed to delete dashboard",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "enum": [
                        "error"
                      ]
                    },
                    "error": {
                      "type": "string",
                      "description": "Error message describing the failure"
                    }
                  },
                  "required": [
                    "status",
                    "error"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/sessions/active": {
      "get": {
        "tags": [
          "sessions"
        ],
        "summary": "Get active sessions (current user)",
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/sessions/invalidate": {
      "post": {
        "tags": [
          "sessions"
        ],
        "summary": "Invalidate a session",
        "requestBody": {
          "required": false
        },
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/sessions/user/{userId}": {
      "get": {
        "tags": [
          "sessions"
        ],
        "summary": "Get sessions for a user",
        "parameters": [
          {
            "in": "path",
            "name": "userId",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/rbac/roles": {
      "get": {
        "tags": [
          "rbac"
        ],
        "summary": "List roles",
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      },
      "post": {
        "tags": [
          "rbac"
        ],
        "summary": "Create role",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/rbac/users/{userId}/roles": {
      "put": {
        "tags": [
          "rbac"
        ],
        "summary": "Assign user roles",
        "parameters": [
          {
            "in": "path",
            "name": "userId",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/ws/metrics": {
      "get": {
        "tags": [
          "ws"
        ],
        "summary": "Metrics stream (WebSocket)",
        "responses": {
          "101": {
            "description": "Switching Protocols"
          }
        }
      }
    },
    "/ws/alerts": {
      "get": {
        "tags": [
          "ws"
        ],
        "summary": "Alerts stream (WebSocket)",
        "responses": {
          "101": {
            "description": "Switching Protocols"
          }
        }
      }
    },
    "/unified/query": {
      "post": {
        "tags": [
          "unified"
        ],
        "summary": "Execute unified query",
        "description": "Execute a unified query across multiple observability engines (metrics, logs, traces).\nThe query router intelligently routes the query to the appropriate engine(s) based on the query type and content.\nSupports caching, correlation, and cross-engine operations.\n",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UnifiedQueryRequest"
              },
              "examples": {
                "metrics_query": {
                  "summary": "Query metrics using MetricsQL",
                  "value": {
                    "query": {
                      "id": "metrics-query-1",
                      "type": "metrics",
                      "query": "http_requests_total{job=\"api\"}",
                      "start_time": "2025-01-01T00:00:00Z",
                      "end_time": "2025-01-01T01:00:00Z",
                      "timeout": "30s",
                      "cache_options": {
                        "enabled": true,
                        "ttl": "5m"
                      }
                    }
                  }
                },
                "logs_query": {
                  "summary": "Query logs using Lucene syntax",
                  "value": {
                    "query": {
                      "id": "logs-query-1",
                      "type": "logs",
                      "query": "service.name:api AND level:error",
                      "start_time": "2025-01-01T00:00:00Z",
                      "end_time": "2025-01-01T01:00:00Z",
                      "timeout": "30s",
                      "parameters": {
                        "limit": 1000
                      }
                    }
                  }
                },
                "traces_query": {
                  "summary": "Query traces",
                  "value": {
                    "query": {
                      "id": "traces-query-1",
                      "type": "traces",
                      "query": "service.name:api",
                      "start_time": "2025-01-01T00:00:00Z",
                      "end_time": "2025-01-01T01:00:00Z",
                      "timeout": "30s"
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Query executed successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UnifiedQueryResponse"
                },
                "example": {
                  "result": {
                    "query_id": "metrics-query-1",
                    "type": "metrics",
                    "status": "success",
                    "data": {
                      "resultType": "vector",
                      "result": [
                        {
                          "metric": {
                            "__name__": "http_requests_total",
                            "job": "api"
                          },
                          "value": [
                            1690000000,
                            "1234"
                          ]
                        }
                      ]
                    },
                    "metadata": {
                      "engine_results": {
                        "metrics": {
                          "engine": "metrics",
                          "status": "success",
                          "record_count": 1,
                          "execution_time_ms": 45,
                          "data_source": "victoriametrics"
                        }
                      },
                      "total_records": 1,
                      "data_sources": [
                        "victoriametrics"
                      ]
                    },
                    "execution_time_ms": 50,
                    "cached": false
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid query format or parameters",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Error message"
                    },
                    "details": {
                      "type": "string",
                      "description": "Detailed error information"
                    }
                  },
                  "required": [
                    "error"
                  ]
                }
              }
            }
          },
          "500": {
            "description": "Query execution failed",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Error message"
                    },
                    "details": {
                      "type": "string",
                      "description": "Detailed error information"
                    },
                    "query_id": {
                      "type": "string",
                      "description": "ID of the failed query"
                    }
                  },
                  "required": [
                    "error"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/unified/correlation": {
      "post": {
        "tags": [
          "unified"
        ],
        "summary": "Execute correlation query",
        "description": "Execute a correlation query that spans multiple engines to find relationships between metrics, logs, and traces.\nSupports time-window correlation, label-based correlation, and cross-engine analysis with confidence scoring.\nUse correlation query syntax like \"logs:error WITHIN 5m OF metrics:cpu_usage > 80\" to find patterns across observability data.\n",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UnifiedQueryRequest"
              },
              "example": {
                "query": {
                  "id": "correlation-query-1",
                  "type": "correlation",
                  "query": "logs:error WITHIN 5m OF metrics:cpu_usage > 80",
                  "start_time": "2025-01-01T00:00:00Z",
                  "end_time": "2025-01-01T01:00:00Z",
                  "timeout": "60s",
                  "correlation_options": {
                    "enabled": true,
                    "correlation_keys": [
                      "service",
                      "instance"
                    ],
                    "time_window": "5m",
                    "engines": [
                      "logs",
                      "metrics"
                    ]
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Correlation query executed successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UnifiedQueryResponse"
                },
                "example": {
                  "result": {
                    "query_id": "correlation-query-1",
                    "type": "correlation",
                    "status": "success",
                    "data": null,
                    "correlations": {
                      "correlations": [
                        {
                          "id": "correlation-123_time_window_1",
                          "correlation_key": "service:api,instance:pod-1",
                          "timestamp": "2025-01-01T00:15:30Z",
                          "engines": {
                            "logs": {
                              "count": 25,
                              "sample": "ERROR Failed to connect to database",
                              "timestamp": "2025-01-01T00:15:30Z"
                            },
                            "metrics": {
                              "cpu_usage": 85.5,
                              "memory_usage": 92.1,
                              "timestamp": "2025-01-01T00:15:30Z"
                            }
                          },
                          "confidence": 0.85,
                          "metadata": {
                            "time_window": "5m0s",
                            "correlation_type": "time_window"
                          }
                        }
                      ],
                      "summary": {
                        "total_correlations": 1,
                        "average_confidence": 0.85,
                        "time_range": "2.5s",
                        "engines_involved": [
                          "logs",
                          "metrics"
                        ]
                      }
                    },
                    "execution_time_ms": 1250,
                    "cached": false
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid correlation query format",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Error message"
                    },
                    "details": {
                      "type": "string",
                      "description": "Detailed error information"
                    }
                  },
                  "required": [
                    "error"
                  ]
                }
              }
            }
          },
          "500": {
            "description": "Correlation query execution failed",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Error message"
                    },
                    "details": {
                      "type": "string",
                      "description": "Detailed error information"
                    },
                    "query_id": {
                      "type": "string",
                      "description": "ID of the failed query"
                    }
                  },
                  "required": [
                    "error"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/unified/metadata": {
      "get": {
        "tags": [
          "unified"
        ],
        "summary": "Get unified query metadata",
        "description": "Retrieve metadata about supported query capabilities, engines, and system configuration.\nIncludes information about supported engines, query capabilities per engine, and caching configuration.\n",
        "responses": {
          "200": {
            "description": "Query metadata retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/QueryMetadata"
                },
                "example": {
                  "supported_engines": [
                    "metrics",
                    "logs",
                    "traces",
                    "correlation"
                  ],
                  "query_capabilities": {
                    "metrics": [
                      "instant",
                      "range",
                      "aggregate",
                      "transform",
                      "rollup"
                    ],
                    "logs": [
                      "lucene",
                      "logsql",
                      "export"
                    ],
                    "traces": [
                      "service",
                      "operation",
                      "flamegraph"
                    ],
                    "correlation": [
                      "cross-engine",
                      "time-window"
                    ]
                  },
                  "cache_capabilities": {
                    "supported": true,
                    "default_ttl": "5m",
                    "max_ttl": "1h"
                  }
                }
              }
            }
          },
          "500": {
            "description": "Failed to retrieve query metadata",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Error message"
                    }
                  },
                  "required": [
                    "error"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/unified/health": {
      "get": {
        "tags": [
          "unified"
        ],
        "summary": "Get unified engine health status",
        "description": "Retrieve the health status of all unified query engines (metrics, logs, traces, correlation).\nReturns overall health status and per-engine health information.\n",
        "responses": {
          "200": {
            "description": "Health status retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EngineHealthStatus"
                },
                "example": {
                  "overall_health": "healthy",
                  "engine_health": {
                    "metrics": "healthy",
                    "logs": "healthy",
                    "traces": "healthy",
                    "correlation": "partial"
                  },
                  "last_checked": "2025-01-01T12:00:00Z"
                }
              }
            }
          },
          "206": {
            "description": "Partial health - some engines unhealthy",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EngineHealthStatus"
                }
              }
            }
          },
          "503": {
            "description": "Service unhealthy - critical engines down",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EngineHealthStatus"
                }
              }
            }
          },
          "500": {
            "description": "Failed to retrieve health status",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "description": "Error message"
                    }
                  },
                  "required": [
                    "error"
                  ]
                }
              }
            }
          }
        }
      }
    }
  }
}