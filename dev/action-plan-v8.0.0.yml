version: "8.0.0"
title: "Mirador Core API Implementation - v8.0.0"
description: "Complete implementation of mirador-core REST API using Weaviate vector database for stateless UI integration with mirador-ui dashboard"
date: "2025-11-06"
status: "planning"

# Enhanced with parallelization opportunities, CI/CD readiness, and observability
# Added parallelizable flags, CI stages, owner roles, and new phases for missing logical links

phases:
  - name: "Weaviate Schema Design"
    description: "Design Weaviate classes and properties for all data models"
    priority: "high"
    tasks:
      - id: "weaviate-schema-kpi-definitions"
        title: "Design KPIDefinition Weaviate class"
        description: "Design Weaviate class for KPI definitions with properties: id, kind, name, unit, format, query_type, query_data, thresholds, tags, sparkline_config, owner_user_id, visibility, timestamps"
        priority: "high"
        status: "not-started"
        dependencies: []
        estimated_effort: "3h"
        assignee: "backend-dev"
        parallelizable: true  # Can be done in parallel with other schema designs
        ci_stage: "pre-commit"  # Schema validation can run in CI
        owner_role: "backend-dev"

      - id: "weaviate-schema-kpi-layouts"
        title: "Design KPILayout Weaviate class"
        description: "Design Weaviate class for KPI layouts with cross-references to KPIDefinition and Dashboard classes, including layout coordinates (x,y,w,h)"
        priority: "high"
        status: "not-started"
        dependencies: ["weaviate-schema-kpi-definitions"]
        estimated_effort: "2h"
        assignee: "backend-dev"
        parallelizable: true  # Parallel with other schema tasks
        ci_stage: "pre-commit"
        owner_role: "backend-dev"

      - id: "weaviate-schema-dashboards"
        title: "Design Dashboard Weaviate class"
        description: "Design Weaviate class for dashboards with id, name, owner_user_id, visibility, timestamps, and ensure 'default' dashboard protection"
        priority: "high"
        status: "not-started"
        dependencies: []
        estimated_effort: "1.5h"
        assignee: "backend-dev"
        parallelizable: true  # Independent schema design
        ci_stage: "pre-commit"
        owner_role: "backend-dev"

      - id: "weaviate-schema-user-preferences"
        title: "Design UserPreferences Weaviate class"
        description: "Design Weaviate class for user preferences with all UI state fields, extensible preferences JSON, and cross-reference to Dashboard class"
        priority: "high"
        status: "not-started"
        dependencies: ["weaviate-schema-dashboards"]
        estimated_effort: "2h"
        assignee: "backend-dev"
        parallelizable: true  # Parallel with other schema tasks
        ci_stage: "pre-commit"
        owner_role: "backend-dev"

      - id: "weaviate-schema-validation"
        title: "Validate Weaviate schema design"
        description: "Ensure schema design supports all API contract requirements and relationships between classes"
        priority: "high"
        status: "not-started"
        dependencies: ["weaviate-schema-kpi-definitions", "weaviate-schema-kpi-layouts", "weaviate-schema-dashboards", "weaviate-schema-user-preferences"]
        estimated_effort: "2h"
        assignee: "backend-dev"
        parallelizable: false  # Must validate all schemas together
        ci_stage: "pre-commit"
        owner_role: "backend-dev"

  - name: "Core Models & Types"
    description: "Define Go structs and types for all API data models"
    priority: "high"
    tasks:
      - id: "models-kpi-def"
        title: "Implement KpiDef model"
        description: "Create Go struct for KpiDef with JSON tags, validation tags, and methods for metric/formula query handling"
        priority: "high"
        status: "not-started"
        dependencies: []
        estimated_effort: "3h"
        assignee: "backend-dev"
        parallelizable: true  # Can be developed in parallel with other models
        ci_stage: "build"  # Compile-time validation
        owner_role: "backend-dev"

      - id: "models-kpi-query"
        title: "Implement KpiQuery model"
        description: "Create Go structs for KpiQuery (metric and formula types) with proper JSON marshaling/unmarshaling"
        priority: "high"
        status: "not-started"
        dependencies: []
        estimated_effort: "2h"
        assignee: "backend-dev"
        parallelizable: true  # Parallel with other model implementations
        ci_stage: "build"
        owner_role: "backend-dev"

      - id: "models-dashboard"
        title: "Implement Dashboard model"
        description: "Create Go struct for Dashboard with validation and timestamp handling"
        priority: "high"
        status: "not-started"
        dependencies: []
        estimated_effort: "1h"
        assignee: "backend-dev"
        parallelizable: true  # Independent model
        ci_stage: "build"
        owner_role: "backend-dev"

      - id: "models-user-preferences"
        title: "Implement UserPreferences model"
        description: "Create Go struct for UserPreferences with extensible preferences JSON field"
        priority: "high"
        status: "not-started"
        dependencies: []
        estimated_effort: "1.5h"
        assignee: "backend-dev"
        parallelizable: true  # Parallel with other models
        ci_stage: "build"
        owner_role: "backend-dev"

      - id: "models-layout"
        title: "Implement Layout model"
        description: "Create Go struct for KPI layout coordinates with grid validation (12-column system)"
        priority: "high"
        status: "not-started"
        dependencies: []
        estimated_effort: "1h"
        assignee: "backend-dev"
        parallelizable: true  # Independent model
        ci_stage: "build"
        owner_role: "backend-dev"

  - name: "Validation & Business Logic"
    description: "Implement validation rules and business logic constraints"
    priority: "high"
    tasks:
      - id: "validation-kpi-def"
        title: "KPI Definition validation"
        description: "Implement validation for KPI definitions: unique IDs, formula expression regex, threshold ordering, required fields"
        priority: "high"
        status: "not-started"
        dependencies: ["models-kpi-def"]
        estimated_effort: "3h"
        assignee: "backend-dev"
        parallelizable: false  # Depends on specific model
        ci_stage: "test"  # Validation tests in CI
        owner_role: "backend-dev"

      - id: "validation-dashboard"
        title: "Dashboard validation"
        description: "Implement validation for dashboards: prevent deletion of 'default' dashboard, visibility hierarchy"
        priority: "high"
        status: "not-started"
        dependencies: ["models-dashboard"]
        estimated_effort: "1.5h"
        assignee: "backend-dev"
        parallelizable: false  # Model-specific
        ci_stage: "test"
        owner_role: "backend-dev"

      - id: "validation-layout"
        title: "Layout validation"
        description: "Implement grid layout validation: 12-column system, min/max dimensions, coordinate bounds"
        priority: "medium"
        status: "not-started"
        dependencies: ["models-layout"]
        estimated_effort: "1h"
        assignee: "backend-dev"
        parallelizable: false  # Model-specific
        ci_stage: "test"
        owner_role: "backend-dev"

      - id: "business-rules-visibility"
        title: "Visibility hierarchy logic"
        description: "Implement visibility filtering logic: private < team < org hierarchy for KPI access control"
        priority: "medium"
        status: "not-started"
        dependencies: []
        estimated_effort: "2h"
        assignee: "backend-dev"
        parallelizable: true  # Can be developed independently
        ci_stage: "test"
        owner_role: "backend-dev"

  - name: "Weaviate Integration"
    description: "Set up Weaviate client and connection management"
    priority: "high"
    tasks:
      - id: "weaviate-client-setup"
        title: "Weaviate Go client integration"
        description: "Integrate Weaviate Go client library and configure connection to Weaviate instance"
        priority: "high"
        status: "not-started"
        dependencies: []
        estimated_effort: "3h"
        assignee: "backend-dev"
        parallelizable: false  # Single integration point
        ci_stage: "build"  # Dependency check
        owner_role: "backend-dev"

      - id: "weaviate-schema-deployment"
        title: "Deploy Weaviate schema"
        description: "Create and deploy Weaviate schema with all classes and properties via REST API"
        priority: "high"
        status: "not-started"
        dependencies: ["weaviate-schema-validation", "weaviate-client-setup"]
        estimated_effort: "2h"
        assignee: "backend-dev"
        parallelizable: false  # Depends on client setup
        ci_stage: "deploy"  # Schema deployment in CI/CD
        owner_role: "backend-dev"

      - id: "weaviate-connection-pooling"
        title: "Connection management and pooling"
        description: "Implement connection pooling, health checks, and error handling for Weaviate client"
        priority: "medium"
        status: "not-started"
        dependencies: ["weaviate-client-setup"]
        estimated_effort: "2h"
        assignee: "backend-dev"
        parallelizable: false  # Builds on client setup
        ci_stage: "test"  # Health check tests
        owner_role: "backend-dev"

  - name: "Weaviate Repository Layer"
    description: "Implement repository pattern using Weaviate REST API"
    priority: "high"
    tasks:
      - id: "weaviate-kpi-def-repo"
        title: "KPI Definitions Weaviate repository"
        description: "Implement CRUD operations for KPIDefinition class using Weaviate REST API: Create, Read, Update, Delete with proper error handling"
        priority: "high"
        status: "not-started"
        dependencies: ["weaviate-schema-deployment", "models-kpi-def"]
        estimated_effort: "4h"
        assignee: "backend-dev"
        parallelizable: true  # Can develop repos in parallel
        ci_stage: "test"  # Unit tests for repos
        owner_role: "backend-dev"

      - id: "weaviate-layout-repo"
        title: "KPI Layouts Weaviate repository"
        description: "Implement batch save/read operations for KPILayout class with cross-reference handling"
        priority: "high"
        status: "not-started"
        dependencies: ["weaviate-schema-deployment", "models-layout"]
        estimated_effort: "3h"
        assignee: "backend-dev"
        parallelizable: true  # Parallel with other repos
        ci_stage: "test"
        owner_role: "backend-dev"

      - id: "weaviate-dashboard-repo"
        title: "Dashboard Weaviate repository"
        description: "Implement CRUD operations for Dashboard class with 'default' dashboard protection"
        priority: "high"
        status: "not-started"
        dependencies: ["weaviate-schema-deployment", "models-dashboard"]
        estimated_effort: "3h"
        assignee: "backend-dev"
        parallelizable: true  # Parallel development
        ci_stage: "test"
        owner_role: "backend-dev"

      - id: "weaviate-user-prefs-repo"
        title: "User Preferences Weaviate repository"
        description: "Implement user preferences CRUD with default value handling and partial updates using Weaviate"
        priority: "high"
        status: "not-started"
        dependencies: ["weaviate-schema-deployment", "models-user-preferences"]
        estimated_effort: "2.5h"
        assignee: "backend-dev"
        parallelizable: true  # Parallel with other repos
        ci_stage: "test"
        owner_role: "backend-dev"

  # New phase added: API Handlers Implementation - missing logical link for endpoint development
  # Added to ensure complete API implementation with contract alignment
  - name: "API Handlers Implementation"
    description: "Implement HTTP handlers for all API endpoints with contract validation"
    priority: "high"
    tasks:
      - id: "api-kpi-defs-get"
        title: "GET /api/v1/kpi/defs handler"
        description: "Implement handler to retrieve all KPI definitions with optional filtering"
        priority: "high"
        status: "not-started"
        dependencies: ["weaviate-kpi-def-repo", "validation-kpi-def"]
        estimated_effort: "2h"
        assignee: "backend-dev"
        parallelizable: true  # Handlers can be developed in parallel
        ci_stage: "test"  # Handler tests
        owner_role: "backend-dev"

      - id: "api-kpi-defs-post"
        title: "POST /api/v1/kpi/defs handler"
        description: "Implement upsert handler for KPI definitions (create or update)"
        priority: "high"
        status: "not-started"
        dependencies: ["weaviate-kpi-def-repo", "validation-kpi-def"]
        estimated_effort: "2.5h"
        assignee: "backend-dev"
        parallelizable: true  # Parallel handler development
        ci_stage: "test"
        owner_role: "backend-dev"

      - id: "api-kpi-defs-delete"
        title: "DELETE /api/v1/kpi/defs/:id handler"
        description: "Implement KPI definition deletion with cascade to layouts"
        priority: "high"
        status: "not-started"
        dependencies: ["weaviate-kpi-def-repo", "weaviate-layout-repo"]
        estimated_effort: "1.5h"
        assignee: "backend-dev"
        parallelizable: true  # Parallel with other handlers
        ci_stage: "test"
        owner_role: "backend-dev"

      - id: "api-layouts-get"
        title: "GET /api/v1/kpi/layouts handler"
        description: "Implement handler to retrieve layouts for a dashboard (default dashboard support)"
        priority: "high"
        status: "not-started"
        dependencies: ["weaviate-layout-repo"]
        estimated_effort: "1.5h"
        assignee: "backend-dev"
        parallelizable: true  # Parallel handler development
        ci_stage: "test"
        owner_role: "backend-dev"

      - id: "api-layouts-batch-post"
        title: "POST /api/v1/kpi/layouts/batch handler"
        description: "Implement batch layout save with transaction support"
        priority: "high"
        status: "not-started"
        dependencies: ["weaviate-layout-repo", "validation-layout"]
        estimated_effort: "2h"
        assignee: "backend-dev"
        parallelizable: true  # Parallel with other handlers
        ci_stage: "test"
        owner_role: "backend-dev"

      - id: "api-dashboards-get"
        title: "GET /api/v1/dashboards handler"
        description: "Implement handler to retrieve all dashboards with user/visibility filtering"
        priority: "high"
        status: "not-started"
        dependencies: ["weaviate-dashboard-repo"]
        estimated_effort: "1.5h"
        assignee: "backend-dev"
        parallelizable: true  # Parallel handler development
        ci_stage: "test"
        owner_role: "backend-dev"

      - id: "api-dashboards-post"
        title: "POST /api/v1/dashboards handler"
        description: "Implement dashboard creation handler"
        priority: "high"
        status: "not-started"
        dependencies: ["weaviate-dashboard-repo", "validation-dashboard"]
        estimated_effort: "1.5h"
        assignee: "backend-dev"
        parallelizable: true  # Parallel with other handlers
        ci_stage: "test"
        owner_role: "backend-dev"

      - id: "api-dashboards-put"
        title: "PUT /api/v1/dashboards/:id handler"
        description: "Implement dashboard update handler"
        priority: "medium"
        status: "not-started"
        dependencies: ["weaviate-dashboard-repo", "validation-dashboard"]
        estimated_effort: "1.5h"
        assignee: "backend-dev"
        parallelizable: true  # Parallel handler development
        ci_stage: "test"
        owner_role: "backend-dev"

      - id: "api-dashboards-delete"
        title: "DELETE /api/v1/dashboards/:id handler"
        description: "Implement dashboard deletion with cascade protection for 'default'"
        priority: "medium"
        status: "not-started"
        dependencies: ["weaviate-dashboard-repo", "validation-dashboard"]
        estimated_effort: "1.5h"
        assignee: "backend-dev"
        parallelizable: true  # Parallel with other handlers
        ci_stage: "test"
        owner_role: "backend-dev"

      - id: "api-user-prefs-get"
        title: "GET /api/v1/user/preferences handler"
        description: "Implement user preferences retrieval with default values"
        priority: "high"
        status: "not-started"
        dependencies: ["weaviate-user-prefs-repo"]
        estimated_effort: "1.5h"
        assignee: "backend-dev"
        parallelizable: true  # Parallel handler development
        ci_stage: "test"
        owner_role: "backend-dev"

      - id: "api-user-prefs-post"
        title: "POST /api/v1/user/preferences handler"
        description: "Implement partial user preferences update (merge with existing)"
        priority: "high"
        status: "not-started"
        dependencies: ["weaviate-user-prefs-repo"]
        estimated_effort: "2h"
        assignee: "backend-dev"
        parallelizable: true  # Parallel with other handlers
        ci_stage: "test"
        owner_role: "backend-dev"

  - name: "Routing & Middleware"
    description: "Set up HTTP routing, middleware, and base infrastructure"
    priority: "high"
    tasks:
      - id: "routing-setup"
        title: "API routing setup"
        description: "Configure Gorilla Mux router with /api/v1 prefix and all endpoint routes"
        priority: "high"
        status: "not-started"
        dependencies: []
        estimated_effort: "2h"
        assignee: "backend-dev"
        parallelizable: false  # Central routing setup
        ci_stage: "build"  # Route validation
        owner_role: "backend-dev"

      - id: "middleware-cors"
        title: "CORS middleware"
        description: "Implement CORS middleware for mirador-ui origins (localhost:3000, mirador-ui:3000)"
        priority: "high"
        status: "not-started"
        dependencies: []
        estimated_effort: "1h"
        assignee: "backend-dev"
        parallelizable: true  # Can be developed independently
        ci_stage: "build"
        owner_role: "backend-dev"

      - id: "middleware-logging"
        title: "Request logging middleware"
        description: "Implement structured logging middleware for all API requests"
        priority: "medium"
        status: "not-started"
        dependencies: []
        estimated_effort: "1.5h"
        assignee: "backend-dev"
        parallelizable: true  # Independent middleware
        ci_stage: "build"
        owner_role: "backend-dev"

      - id: "middleware-error"
        title: "Error handling middleware"
        description: "Implement centralized error handling middleware with proper HTTP status codes"
        priority: "high"
        status: "not-started"
        dependencies: []
        estimated_effort: "2h"
        assignee: "backend-dev"
        parallelizable: true  # Independent middleware
        ci_stage: "build"
        owner_role: "backend-dev"

  - name: "Error Handling & Responses"
    description: "Implement standardized error responses and validation error formatting"
    priority: "high"
    tasks:
      - id: "error-responses"
        title: "Standard error response format"
        description: "Implement consistent error response structure: {error: string} with proper HTTP status codes"
        priority: "high"
        status: "not-started"
        dependencies: ["middleware-error"]
        estimated_effort: "2h"
        assignee: "backend-dev"
        parallelizable: false  # Depends on middleware
        ci_stage: "test"  # Error response tests
        owner_role: "backend-dev"

      - id: "validation-errors"
        title: "Validation error handling"
        description: "Implement field-level validation error formatting and aggregation"
        priority: "high"
        status: "not-started"
        dependencies: ["validation-kpi-def", "validation-dashboard", "validation-layout"]
        estimated_effort: "2h"
        assignee: "backend-dev"
        parallelizable: false  # Depends on validation logic
        ci_stage: "test"
        owner_role: "backend-dev"

  - name: "Weaviate Data Seeding"
    description: "Create data seeding for initial Weaviate objects"
    priority: "medium"
    tasks:
      - id: "seed-default-dashboard-weaviate"
        title: "Seed default dashboard in Weaviate"
        description: "Create and import the required 'default' dashboard object in Weaviate"
        priority: "high"
        status: "not-started"
        dependencies: ["weaviate-schema-deployment"]
        estimated_effort: "1h"
        assignee: "backend-dev"
        parallelizable: false  # Depends on schema deployment
        ci_stage: "deploy"  # Seeding in deployment
        owner_role: "backend-dev"

      - id: "seed-sample-kpis-weaviate"
        title: "Seed sample KPI definitions in Weaviate"
        description: "Create optional sample KPI definition objects for development/demo purposes"
        priority: "low"
        status: "not-started"
        dependencies: ["seed-default-dashboard-weaviate"]
        estimated_effort: "2h"
        assignee: "backend-dev"
        parallelizable: true  # Can be done after basic seeding
        ci_stage: "deploy"
        owner_role: "backend-dev"

      - id: "seed-default-user-prefs-weaviate"
        title: "Seed default user preferences in Weaviate"
        description: "Create default user preferences objects with sensible defaults"
        priority: "medium"
        status: "not-started"
        dependencies: ["seed-default-dashboard-weaviate"]
        estimated_effort: "1h"
        assignee: "backend-dev"
        parallelizable: true  # Parallel with sample KPIs
        ci_stage: "deploy"
        owner_role: "backend-dev"

  # New phase added: Mock Testing - for early validation and parallel development
  # Added to enable frontend-backend parallel development and early API contract validation
  - name: "Mock Testing & Contract Validation"
    description: "Implement mock services and contract testing for frontend alignment"
    priority: "medium"
    tasks:
      - id: "mock-weaviate-service"
        title: "Create mock Weaviate service"
        description: "Implement in-memory mock Weaviate service for testing without full Weaviate setup"
        priority: "medium"
        status: "not-started"
        dependencies: ["weaviate-schema-validation"]
        estimated_effort: "4h"
        assignee: "backend-dev"
        parallelizable: true  # Can be developed early
        ci_stage: "test"  # Mock tests in CI
        owner_role: "backend-dev"
        # Added for parallel frontend development

      - id: "contract-validation-tests"
        title: "API contract validation tests"
        description: "Create tests to validate API responses match mirador-ui TypeScript types and contract"
        priority: "high"
        status: "not-started"
        dependencies: ["api-kpi-defs-get", "api-user-prefs-get"]
        estimated_effort: "3h"
        assignee: "backend-dev"
        parallelizable: true  # Can run with handler development
        ci_stage: "test"
        owner_role: "backend-dev"
        # Ensures frontend-backend alignment

  - name: "Testing"
    description: "Comprehensive testing suite"
    priority: "high"
    tasks:
      - id: "unit-tests-models"
        title: "Unit tests for models"
        description: "Write unit tests for all data models, validation logic, and business rules"
        priority: "high"
        status: "not-started"
        dependencies: ["models-kpi-def", "models-dashboard", "models-user-preferences", "models-layout"]
        estimated_effort: "6h"
        assignee: "backend-dev"
        parallelizable: true  # Can be developed in parallel with implementation
        ci_stage: "test"
        owner_role: "backend-dev"

      - id: "integration-tests-api"
        title: "API integration tests"
        description: "Write integration tests for all API endpoints with real database"
        priority: "high"
        status: "not-started"
        dependencies: ["api-kpi-defs-get", "api-kpi-defs-post", "api-layouts-get", "api-dashboards-get", "api-user-prefs-get"]
        estimated_effort: "8h"
        assignee: "backend-dev"
        parallelizable: false  # Requires full API implementation
        ci_stage: "test"
        owner_role: "backend-dev"

      - id: "tests-validation"
        title: "Validation tests"
        description: "Test all validation rules: formula expressions, layout bounds, required fields, etc."
        priority: "high"
        status: "not-started"
        dependencies: ["validation-kpi-def", "validation-dashboard", "validation-layout"]
        estimated_effort: "4h"
        assignee: "backend-dev"
        parallelizable: true  # Can run with validation implementation
        ci_stage: "test"
        owner_role: "backend-dev"

      - id: "tests-error-handling"
        title: "Error handling tests"
        description: "Test error responses, HTTP status codes, and edge cases"
        priority: "medium"
        status: "not-started"
        dependencies: ["error-responses", "validation-errors"]
        estimated_effort: "3h"
        assignee: "backend-dev"
        parallelizable: true  # Can run with error handling
        ci_stage: "test"
        owner_role: "backend-dev"

  # New phase added: CI/CD Pipeline - for automated testing and deployment
  # Added to ensure CI/CD readiness and automated quality gates
  - name: "CI/CD Pipeline & Automation"
    description: "Set up continuous integration and deployment pipeline"
    priority: "medium"
    tasks:
      - id: "ci-linting"
        title: "Code linting and formatting"
        description: "Configure Go linting, formatting, and static analysis tools (golangci-lint, gofmt)"
        priority: "high"
        status: "not-started"
        dependencies: []
        estimated_effort: "2h"
        assignee: "devops"
        parallelizable: true  # Can be set up early
        ci_stage: "pre-commit"
        owner_role: "devops"
        # Ensures code quality from day one

      - id: "ci-testing-pipeline"
        title: "Automated testing pipeline"
        description: "Set up GitHub Actions/Jenkins for unit, integration, and contract tests"
        priority: "high"
        status: "not-started"
        dependencies: ["unit-tests-models", "integration-tests-api"]
        estimated_effort: "4h"
        assignee: "devops"
        parallelizable: false  # Depends on test implementation
        ci_stage: "test"
        owner_role: "devops"
        # Enables automated testing

      - id: "ci-deployment-pipeline"
        title: "Deployment pipeline"
        description: "Configure automated deployment to staging/production with Weaviate schema migration"
        priority: "medium"
        status: "not-started"
        dependencies: ["weaviate-schema-deployment", "deployment-weaviate-config"]
        estimated_effort: "3h"
        assignee: "devops"
        parallelizable: false  # Depends on deployment config
        ci_stage: "deploy"
        owner_role: "devops"
        # Ensures reliable deployments

  - name: "Documentation & Deployment"
    description: "API documentation and deployment configuration"
    priority: "medium"
    tasks:
      - id: "api-docs-openapi"
        title: "OpenAPI specification"
        description: "Generate OpenAPI 3.0 spec from code annotations for API documentation"
        priority: "medium"
        status: "not-started"
        dependencies: ["routing-setup"]
        estimated_effort: "4h"
        assignee: "backend-dev"
        parallelizable: true  # Can be done with implementation
        ci_stage: "build"  # Docs generation in CI
        owner_role: "backend-dev"

      - id: "deployment-weaviate-config"
        title: "Weaviate deployment configuration"
        description: "Create Docker, Kubernetes configs for mirador-core service with Weaviate dependency"
        priority: "medium"
        status: "not-started"
        dependencies: []
        estimated_effort: "3h"
        assignee: "devops"
        parallelizable: true  # Can be developed early
        ci_stage: "deploy"
        owner_role: "devops"

      - id: "health-endpoints"
        title: "Health check endpoints"
        description: "Implement /health and /ready endpoints for Kubernetes probes"
        priority: "medium"
        status: "not-started"
        dependencies: ["routing-setup"]
        estimated_effort: "1h"
        assignee: "backend-dev"
        parallelizable: true  # Simple endpoint
        ci_stage: "build"
        owner_role: "backend-dev"

      - id: "monitoring-setup"
        title: "Monitoring and observability"
        description: "Add metrics collection, structured logging, and tracing support"
        priority: "low"
        status: "not-started"
        dependencies: ["middleware-logging"]
        estimated_effort: "4h"
        assignee: "backend-dev"
        parallelizable: true  # Can be added incrementally
        ci_stage: "deploy"
        owner_role: "backend-dev"

total_estimated_effort: "140h"  # Increased due to new phases and parallelization overhead
critical_path:
  - "Weaviate Schema Design"
  - "Weaviate Integration"
  - "Core Models & Types"
  - "Weaviate Repository Layer"
  - "API Handlers Implementation"
  - "Routing & Middleware"
  # Added CI/CD for governance

milestones:
  - name: "Weaviate Schema Ready"
    description: "Weaviate schema designed, validated, and deployed"
    tasks: ["weaviate-schema-kpi-definitions", "weaviate-schema-kpi-layouts", "weaviate-schema-dashboards", "weaviate-schema-user-preferences", "weaviate-schema-validation", "weaviate-client-setup", "weaviate-schema-deployment"]
    due_date: "2025-11-13"

  - name: "Core API Working"
    description: "Basic CRUD operations working for all entities using Weaviate"
    tasks: ["models-kpi-def", "models-dashboard", "models-user-preferences", "weaviate-kpi-def-repo", "weaviate-dashboard-repo", "weaviate-user-prefs-repo", "api-kpi-defs-get", "api-kpi-defs-post", "api-dashboards-get", "api-user-prefs-get", "routing-setup"]
    due_date: "2025-11-20"

  - name: "Full API Complete"
    description: "All API endpoints implemented with validation and error handling using Weaviate"
    tasks: ["api-kpi-defs-delete", "api-layouts-get", "api-layouts-batch-post", "api-dashboards-post", "api-dashboards-put", "api-dashboards-delete", "api-user-prefs-post", "validation-kpi-def", "validation-dashboard", "error-responses"]
    due_date: "2025-11-27"

  - name: "Testing Complete"
    description: "Comprehensive test coverage and validation with Weaviate"
    tasks: ["unit-tests-models", "integration-tests-api", "tests-validation", "tests-error-handling"]
    due_date: "2025-12-04"

  - name: "Production Ready"
    description: "Seeding, documentation, and deployment configs complete for Weaviate"
    tasks: ["seed-default-dashboard-weaviate", "seed-default-user-prefs-weaviate", "api-docs-openapi", "deployment-weaviate-config", "health-endpoints"]
    due_date: "2025-12-11"

# Enhanced risks with actionable mitigations
risks:
  - description: "Complex formula validation logic may require multiple iterations"
    mitigation: "Start with basic regex validation, iterate based on test cases. Schedule weekly validation reviews."
    impact: "medium"
    probability: "medium"
    action_items: ["Create validation test suite early", "Schedule bi-weekly validation reviews", "Document edge cases"]

  - description: "Weaviate schema evolution and data migration challenges"
    mitigation: "Design schema to be backward compatible, implement proper migration strategies. Use Weaviate's schema versioning."
    impact: "high"
    probability: "medium"
    action_items: ["Review Weaviate migration docs", "Implement schema versioning", "Test migrations with sample data"]

  - description: "Weaviate performance characteristics for complex queries"
    mitigation: "Profile query performance early, optimize with proper indexing and batch operations. Set up performance benchmarks."
    impact: "medium"
    probability: "medium"
    action_items: ["Implement query profiling", "Set performance SLIs", "Optimize batch operations"]

  - description: "Weaviate cluster management and high availability"
    mitigation: "Use managed Weaviate service or implement proper clustering configuration. Plan for multi-zone deployment."
    impact: "high"
    probability: "low"
    action_items: ["Evaluate managed Weaviate options", "Design HA architecture", "Implement failover testing"]

assumptions:
  - "Go 1.21+ with Weaviate Go client library"
  - "Weaviate 1.24+ instance available (cloud or self-hosted)"
  - "No authentication required for v8.0.0 (as per contract)"
  - "Single mirador-core instance (no clustering considerations yet)"
  - "mirador-ui will handle optimistic UI updates and error recovery"
  - "Weaviate vector capabilities not required for v8.0.0 (can be added later)"

dependencies:
  - name: "mirador-ui contract alignment"
    description: "Ensure API contract matches mirador-ui expectations"
    owner: "platform-team"
    status: "completed"

  - name: "Weaviate infrastructure"
    description: "Weaviate instance available for development and production"
    owner: "devops"
    status: "pending"

  - name: "Weaviate Go client"
    description: "Official Weaviate Go client library available and compatible"
    owner: "backend-dev"
    status: "pending"
